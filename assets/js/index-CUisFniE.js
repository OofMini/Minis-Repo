(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(o){if(o.ep)return;o.ep=!0;const s=r(o);fetch(o.href,s)}})();const K=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||window.location.hostname==="0.0.0.0"||window.location.hostname==="[::1]"),m={API_ENDPOINT:K?"./mini.json":"https://OofMini.github.io/Minis-Repo/mini.json",FALLBACK_ICON:"./apps/repo-icon.png",FEATURED_BUNDLE_ID:"com.spotify.client",SEARCH_DEBOUNCE:150,TOAST_DURATION:4e3,FETCH_TIMEOUT:1e4,CARD_POOL_SIZE:24,OVERSCAN_ROWS:3,CARD_ROW_HEIGHT:88,CARD_GAP:12,SW_UPDATE_INTERVAL:1800*1e3,MAX_RECENT_SEARCHES:5,IDB_NAME:"minis-repo",IDB_VERSION:1,SPRING_BOUNCY:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",SPRING_SMOOTH:"cubic-bezier(0.4, 0, 0.2, 1)",MANIFEST_URL:"https://OofMini.github.io/Minis-Repo/mini.json",BASE_URL:K?window.location.origin+window.location.pathname:"https://OofMini.github.io/Minis-Repo/"},X=document.createElement("div");function E(t){return t?(X.textContent=t,X.innerHTML):""}function y(t){return t?String(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}const ye="#a78bfa";function we(t){return t&&/^#[0-9A-Fa-f]{6}$/.test(t)?t:ye}function I(t,e){if(!t||t.length<7)return`rgba(167, 139, 250, ${e})`;const r=parseInt(t.slice(1,3),16),n=parseInt(t.slice(3,5),16),o=parseInt(t.slice(5,7),16);return isNaN(r)||isNaN(n)||isNaN(o)?`rgba(167, 139, 250, ${e})`:`rgba(${r}, ${n}, ${o}, ${e})`}function be(t){return!t||typeof t!="number"?"Unknown":t>=1073741824?`${(t/1073741824).toFixed(1)} GB`:`${(t/1048576).toFixed(0)} MB`}function Ee(t){if(!t)return"";const e=new Date(t+"T00:00:00Z"),n=Date.now()-e.getTime(),o=Math.floor(n/864e5);return o<0?"Just now":o===0?"Today":o===1?"Yesterday":o<7?`${o}d ago`:o<30?`${Math.floor(o/7)}w ago`:o<365?`${Math.floor(o/30)}mo ago`:`${Math.floor(o/365)}y ago`}function Ce(t){const e=t.toLowerCase();return e.includes("youtubemusic")||e.includes("spotify")||e.includes("music")?"Music":e.includes("youtube")||e.includes("video")?"Video":e.includes("social")||e.includes("tweet")||e.includes("twitter")?"Social":e.includes("editor")||e.includes("inshot")||e.includes("photo")||e.includes("reface")||e.includes("doublicatapp")?"Creative":"Utilities"}function Le(t,e){return t?t.toLowerCase():`unknown-${e}`}function Ie(t){if(!t||typeof t!="string")return!1;try{const e=new URL(t);return e.protocol==="https:"&&e.hostname.length>0}catch{return!1}}function Ae(t,e){let r;return(...n)=>{clearTimeout(r),r=setTimeout(()=>t(...n),e)}}function Se(t,e){return new Promise(r=>{try{const n=indexedDB.open("minis-repo",1);n.onupgradeneeded=()=>{const o=n.result;o.objectStoreNames.contains("searches")||o.createObjectStore("searches",{keyPath:"key"}),o.objectStoreNames.contains("data")||o.createObjectStore("data",{keyPath:"key"})},n.onsuccess=()=>{try{const i=n.result.transaction(t,"readonly").objectStore(t).get(e);i.onsuccess=()=>r(i.result?.value),i.onerror=()=>r(void 0)}catch{r(void 0)}},n.onerror=()=>r(void 0)}catch{r(void 0)}})}function ke(t,e,r){return new Promise(n=>{try{const o=indexedDB.open("minis-repo",1);o.onupgradeneeded=()=>{const s=o.result;s.objectStoreNames.contains("searches")||s.createObjectStore("searches",{keyPath:"key"}),s.objectStoreNames.contains("data")||s.createObjectStore("data",{keyPath:"key"})},o.onsuccess=()=>{try{const s=o.result.transaction(t,"readwrite");s.objectStore(t).put({key:e,value:r}),s.oncomplete=()=>n(),s.onerror=()=>n()}catch{n()}},o.onerror=()=>n()}catch{n()}})}function Te(t){return Array.isArray(t)?t.map(e=>typeof e=="string"?{type:e,usageDescription:""}:typeof e=="object"&&e!==null&&"type"in e?{type:e.type,usageDescription:e.usageDescription??""}:null).filter(e=>e!==null):[]}function H(t,e,r,n){if(!e)return{score:0,ranges:[]};if(e===t)return{score:1*r,ranges:[[0,e.length]]};if(e.startsWith(t))return{score:.95*r,ranges:[[0,t.length]]};const o=e.indexOf(t);if(o>=0)return{score:(.8+(o===0||/\W/.test(e[o-1])?.05:0))*r,ranges:[[o,o+t.length]]};const s=n??M(e),i=xe(t,e,s);if(i)return{score:.65*r,ranges:i};const c=Be(t,e);if(c){const l=c[c.length-1][1]-c[0][0],d=t.length/Math.max(l,1);return{score:Math.min(.5,.3+d*.2)*r,ranges:c}}return{score:0,ranges:[]}}function M(t){const e=[0];for(let r=1;r<t.length;r++)/\W/.test(t[r-1])&&/\w/.test(t[r])&&e.push(r);return e}function xe(t,e,r){if(r.length<t.length)return null;const n=[];let o=0;for(let s=0;s<t.length;s++){let i=!1;for(;o<r.length;){if(e[r[o]]===t[s]){n.push([r[o],r[o]+1]),o++,i=!0;break}o++}if(!i)return null}return n}function Be(t,e){const r=[];let n=0;for(let o=0;o<t.length;o++){let s=!1;for(;n<e.length;){if(e[n]===t[o]){r.length>0&&r[r.length-1][1]===n?r[r.length-1][1]=n+1:r.push([n,n+1]),n++,s=!0;break}n++}if(!s)return null}return r}function oe(t,e){const r=t.toLowerCase().trim();if(!r)return e.map(o=>({app:o,score:1,nameMatches:[]}));const n=[];for(const o of e){const s=H(r,o._searchName,1,o._wordStartsName),i=H(r,o._searchDev,.7,o._wordStartsDev),c=H(r,o._searchDesc,.4,o._wordStartsDesc);let l=0,d=[];s.score>=i.score&&s.score>=c.score?(l=s.score,d=s.ranges):i.score>=c.score?(l=i.score,d=[]):(l=c.score,d=[]),l>0&&n.push({app:o,score:l,nameMatches:s.score>0?s.ranges:d})}return n.sort((o,s)=>s.score!==o.score?s.score-o.score:o.app.name.localeCompare(s.app.name)),n}function re(t,e){if(!e.length)return R(t);let r="",n=0;const o=[...e].sort((i,c)=>i[0]-c[0]),s=[];for(const i of o)s.length>0&&i[0]<=s[s.length-1][1]?s[s.length-1][1]=Math.max(s[s.length-1][1],i[1]):s.push([...i]);for(const[i,c]of s)n<i&&(r+=R(t.slice(n,i))),r+=`<mark>${R(t.slice(i,c))}</mark>`,n=c;return n<t.length&&(r+=R(t.slice(n))),r}function R(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}class Re{constructor(e,r){this.items=[],this.pool=[],this.activeNodes=new Map,this.columns=1,this.rowHeight=m.CARD_ROW_HEIGHT,this.gap=m.CARD_GAP,this.containerTop=0,this.rafId=0,this.resizeObserver=null,this.resizeRafId=0,this.cachedPaddingLeft=0,this.cachedPaddingRight=0,this.cachedContainerWidth=0,this.cachedAvailableWidth=0,this.cachedColWidth=0,this.container=e,this.callbacks=r,this.innerContainer=document.createElement("div"),this.innerContainer.className="vs-inner",this.innerContainer.setAttribute("role","list"),this.innerContainer.setAttribute("aria-label","App list"),this.container.appendChild(this.innerContainer);for(let n=0;n<m.CARD_POOL_SIZE;n++){const o=r.createCardNode();o.style.position="absolute",o.style.left="0",o.style.top="0",o.style.display="none",o.setAttribute("role","listitem"),this.innerContainer.appendChild(o),this.pool.push({el:o,appId:null})}this.setupListeners(),this.computeLayout()}setupListeners(){const e=()=>{this.rafId||(this.rafId=requestAnimationFrame(()=>{this.rafId=0,this.render()}))};window.addEventListener("scroll",e,{passive:!0}),this.resizeObserver=new ResizeObserver(()=>{this.resizeRafId&&cancelAnimationFrame(this.resizeRafId),this.resizeRafId=requestAnimationFrame(()=>{this.resizeRafId=0,this.computeLayout(),this.render()})}),this.resizeObserver.observe(this.container),this.innerContainer.addEventListener("click",r=>{const n=r.target.closest("[data-app-id]");if(!n||r.target.closest("button"))return;const s=n.dataset.appId;s&&this.callbacks.onCardClick(s)}),this.innerContainer.addEventListener("keydown",r=>{const n=r.target.closest("[data-app-id]");if(n){if(r.key==="Enter"||r.key===" "){r.preventDefault();const o=n.dataset.appId;o&&this.callbacks.onCardClick(o);return}["ArrowRight","ArrowLeft","ArrowDown","ArrowUp"].includes(r.key)&&(r.preventDefault(),this.navigateGrid(n,r.key))}})}navigateGrid(e,r){const n=e.dataset.appId;if(!n)return;const o=this.items.findIndex(i=>i.id===n);if(o===-1)return;let s=o;switch(r){case"ArrowRight":s=Math.min(o+1,this.items.length-1);break;case"ArrowLeft":s=Math.max(o-1,0);break;case"ArrowDown":s=Math.min(o+this.columns,this.items.length-1);break;case"ArrowUp":s=Math.max(o-this.columns,0);break}if(s!==o){const i=this.items[s];this.scrollToIndex(s),requestAnimationFrame(()=>{const c=this.activeNodes.get(i.id);c&&c.el.focus({preventScroll:!1})})}}computeLayout(){const e=getComputedStyle(this.container);this.cachedContainerWidth=this.container.clientWidth,this.cachedPaddingLeft=parseFloat(e.paddingLeft)||0,this.cachedPaddingRight=parseFloat(e.paddingRight)||0,this.cachedAvailableWidth=this.cachedContainerWidth-this.cachedPaddingLeft-this.cachedPaddingRight,this.cachedAvailableWidth>=900?this.columns=3:this.cachedAvailableWidth>=540?this.columns=2:this.columns=1;const r=e.getPropertyValue("--vs-gap")?.trim();r&&(this.gap=parseInt(r,10)||m.CARD_GAP),this.cachedColWidth=(this.cachedAvailableWidth-(this.columns-1)*this.gap)/this.columns,this.containerTop=this.container.getBoundingClientRect().top+window.scrollY}setItems(e){this.items=e;const n=Math.ceil(e.length/this.columns)*(this.rowHeight+this.gap)-this.gap;this.innerContainer.style.height=`${Math.max(n,0)}px`;for(const[o,s]of this.activeNodes)s.el.style.display="none",s.appId=null,this.pool.push(s),this.activeNodes.delete(o);this.render()}acquireNode(){if(this.pool.length>0)return this.pool.pop()}releaseNode(e){e.appId&&this.activeNodes.delete(e.appId),e.el.style.display="none",e.appId=null,this.pool.push(e)}render(){if(this.items.length===0){for(const[,h]of this.activeNodes)this.releaseNode(h);return}const e=window.scrollY,r=window.innerHeight,n=r*2,o=this.containerTop,s=this.rowHeight+this.gap,i=Math.ceil(this.items.length/this.columns),c=e-o-n,l=e+r-o+n,d=Math.max(0,Math.floor(c/s)),p=Math.min(i-1,Math.ceil(l/s)),f=d*this.columns,g=Math.min((p+1)*this.columns,this.items.length),v=new Set;for(let h=f;h<g;h++)v.add(this.items[h].id);for(const[h,S]of this.activeNodes)v.has(h)||this.releaseNode(S);const b=this.cachedPaddingLeft,u=this.cachedColWidth;for(let h=f;h<g;h++){const S=this.items[h];let C=this.activeNodes.get(S.id);if(!C){if(C=this.acquireNode(),!C)continue;C.appId=S.id,this.activeNodes.set(S.id,C),this.callbacks.bindCard(C.el,S,h)}const me=Math.floor(h/this.columns),fe=h%this.columns,ge=b+fe*(u+this.gap),ve=me*s;C.el.style.transform=`translate3d(${ge}px, ${ve}px, 0)`,C.el.style.width=`${u}px`,C.el.style.height=`${this.rowHeight}px`,C.el.style.display=""}}scrollToIndex(e){const r=Math.floor(e/this.columns),n=this.rowHeight+this.gap,o=this.containerTop+r*n,s=window.innerHeight;(o<window.scrollY||o+this.rowHeight>window.scrollY+s)&&window.scrollTo({top:o-s/3,behavior:"smooth"}),requestAnimationFrame(()=>this.render())}setRowHeight(e){if(e>0&&e!==this.rowHeight){this.rowHeight=e;const n=Math.ceil(this.items.length/this.columns)*(this.rowHeight+this.gap)-this.gap;this.innerContainer.style.height=`${Math.max(n,0)}px`,this.render()}}getActiveNodeCount(){return this.activeNodes.size}destroy(){this.rafId&&cancelAnimationFrame(this.rafId),this.resizeRafId&&cancelAnimationFrame(this.resizeRafId),this.resizeObserver?.disconnect(),this.innerContainer.remove()}}let U=null,A=null,D=[],j=!1;function se(){return U||(U=document.getElementById("toast")),U}function w(t,e="info",r){const n=se();if(n){if(j){D.push({msg:t,type:e,action:r}),D.length>2&&F();return}ie(n,t,e,r)}}function ie(t,e,r,n){j=!0,A&&(clearTimeout(A),A=null),t.innerHTML="";const o=document.createElement("span");if(o.textContent=e,t.appendChild(o),n){const s=document.createElement("button");s.type="button",s.textContent=n.text,s.addEventListener("click",()=>{n.callback(),F()}),t.appendChild(s)}t.setAttribute("aria-live",r==="error"||r==="warning"?"assertive":"polite"),t.className=`toast ${r} show`,A=setTimeout(()=>{F()},m.TOAST_DURATION)}function F(){const t=se();if(t&&(t.classList.remove("show"),j=!1,A&&(clearTimeout(A),A=null),D.length>0)){const e=D.shift();setTimeout(()=>{ie(t,e.msg,e.type,e.action)},300)}}function Me(){const t=document.createElement("article");return t.className="app-card",t.tabIndex=0,t.innerHTML=`
        <div class="card-accent" aria-hidden="true"></div>
        <div class="card-body">
            <div class="card-icon-wrap">
                <img class="card-icon" width="64" height="64" loading="lazy" decoding="async" alt="">
                <span class="card-version-badge" aria-hidden="true"></span>
            </div>
            <div class="card-info">
                <h3 class="card-name"></h3>
                <p class="card-developer"></p>
                <p class="card-meta"></p>
            </div>
            <button type="button" class="card-get-btn" aria-label="">
                <span class="card-get-text">GET</span>
                <span class="card-get-spinner" aria-hidden="true"></span>
                <span class="card-get-check" aria-hidden="true"></span>
            </button>
        </div>
        <div class="card-separator" aria-hidden="true"></div>
    `,t}function Oe(t,e,r,n){t.dataset.appId=e.id,t.setAttribute("aria-label",`${e.name} by ${e.developer} ‚Äî tap to view details`),t.style.setProperty("--tint",e.tintColor),t.style.setProperty("--tint-10",I(e.tintColor,.1)),t.style.setProperty("--tint-20",I(e.tintColor,.2)),t.style.setProperty("--tint-40",I(e.tintColor,.4));const o=t.querySelector(".card-accent");o&&(o.style.backgroundColor=e.tintColor);const s=t.querySelector(".card-icon");s&&s.src!==e.icon&&!s.src.endsWith(e.icon)&&(s.src=e.icon,s.alt=`${e.name} icon`,s.onerror=()=>{s.src=m.FALLBACK_ICON});const i=t.querySelector(".card-version-badge");i&&(i.textContent=`v${e.version}`);const c=t.querySelector(".card-name");c&&(n&&n.length>0?c.innerHTML=re(e.name,n):c.textContent=e.name);const l=t.querySelector(".card-developer");l&&(l.textContent=e.developer);const d=t.querySelector(".card-meta");d&&(d.textContent=`${e.size} ¬∑ ${Ee(e.date)}`);const p=t.querySelector(".card-get-btn");if(p){p.dataset.id=e.id,p.setAttribute("aria-label",`Download ${e.name}`),p.className="card-get-btn",p.style.setProperty("--btn-tint",e.tintColor),p.style.setProperty("--btn-tint-bg",I(e.tintColor,.12));const f=p.querySelector(".card-get-text");f&&(f.style.display="");const g=p.querySelector(".card-get-spinner");g&&(g.style.display="none");const v=p.querySelector(".card-get-check");v&&(v.style.display="none")}}function Y(t,e,r){const n=e.find(i=>i.id===t);if(!n)return;if(!r){w("You are offline. Downloads require a connection.","warning");return}if(!Ie(n.downloadUrl)){w("Security Block: URL must be HTTPS","error");return}const o=document.querySelector(`.card-get-btn[data-id="${CSS.escape(t)}"]`);o&&$e(o);const s=document.createElement("a");s.href=n.downloadUrl,s.target="_blank",s.rel="noopener noreferrer",s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s),w(`Downloading ${n.name}`,"success")}function $e(t){const e=t.querySelector(".card-get-text"),r=t.querySelector(".card-get-spinner"),n=t.querySelector(".card-get-check");!e||!r||!n||(t.classList.add("downloading"),e.style.display="none",r.style.display="",setTimeout(()=>{r.style.display="none",n.style.display="",t.classList.remove("downloading"),t.classList.add("downloaded"),setTimeout(()=>{t.classList.remove("downloaded"),e.style.display="",n.style.display="none"},2e3)},800))}function _e(t,e,r,n){const o=r.querySelector(".featured-icon"),s=r.querySelector(".featured-name"),i=r.querySelector(".featured-dev"),c=r.querySelector(".featured-desc"),l=r.querySelector(".featured-get-btn");o&&(o.src=t.icon,o.alt=`${t.name} icon`,o.onerror=()=>{o.src=m.FALLBACK_ICON}),s&&(s.textContent=t.name),i&&(i.textContent=t.developer),c&&(c.textContent=t.description),l&&(l.dataset.id=t.id,l.setAttribute("aria-label",`Download ${t.name}`),l.style.setProperty("--btn-tint",t.tintColor)),r.style.setProperty("--tint",t.tintColor),r.style.setProperty("--tint-10",I(t.tintColor,.1)),r.style.setProperty("--tint-20",I(t.tintColor,.2)),r.setAttribute("data-app-id",t.id),r.setAttribute("aria-label",`${t.name} ‚Äî featured app, tap to view details`),e.removeAttribute("hidden"),e.classList.add("visible"),r.addEventListener("click",d=>{d.target.closest("button")||n(t.id)}),r.addEventListener("keydown",d=>{(d.key==="Enter"||d.key===" ")&&(d.preventDefault(),n(t.id))})}function De(t){const e=document.createElement("link");e.rel="preconnect",e.href="https://objects.githubusercontent.com",e.crossOrigin="anonymous",document.head.appendChild(e);const r=Math.min(6,t.length);for(let n=0;n<r;n++){const o=document.createElement("link");o.rel="preload",o.as="image",o.href=t[n].icon,n<3&&o.setAttribute("fetchpriority","high"),document.head.appendChild(o)}}let P=null,N=null;function B(t,e,r=!1){const n=e.apps.find(u=>u.id===t);if(!n||e.modalOpen)return;e.modalOpen=!0,e.modalScrollY=window.scrollY,e.lastOpenedCardId=t,Ue(n),P?.remove(),ae(n.bundleId,r,e);const o=document.getElementById("themeColor");o&&(o.content="#0a0a0f");const s=document.createElement("div");s.id="appModal",s.className="modal-overlay",s.setAttribute("role","dialog"),s.setAttribute("aria-modal","true"),s.setAttribute("aria-label",`${n.name} details`);const i=n.screenshots.length>0?`<div class="modal-screenshots" role="region" aria-label="Screenshots">
                <div class="modal-screenshots-track">
                    ${n.screenshots.map((u,h)=>`<img src="${y(u)}" alt="${y(n.name)} screenshot ${h+1}" loading="eager" decoding="async" class="modal-screenshot" data-idx="${h}">`).join("")}
                </div>
                <div class="modal-dots" aria-hidden="true">
                    ${n.screenshots.map((u,h)=>`<span class="modal-dot${h===0?" active":""}"></span>`).join("")}
                </div>
            </div>`:"",c=n.permissions.length>0?`<div class="modal-permissions">
                <span class="modal-permissions-label">Permissions:</span>
                ${n.permissions.map(u=>`<span class="modal-perm-tag" title="${y(u.usageDescription)}">${E(u.type)}</span>`).join("")}
            </div>`:"",l=n.changelog?`<div class="modal-changelog">
            <strong>What's New</strong>
            <p>${E(n.changelog)}</p>
        </div>`:"",d=(e.developerIndex?.get(n.developer)??[]).filter(u=>u.id!==n.id),p=d.length>0?`<div class="modal-more-section">
                <h4>More by ${E(n.developer)}</h4>
                <div class="modal-more-row">
                    ${d.map(u=>`<button type="button" class="modal-more-item" data-app-id="${y(u.id)}" aria-label="View ${y(u.name)}">
                            <img src="${y(u.icon)}" alt="" width="48" height="48" loading="lazy" decoding="async" class="modal-more-icon">
                            <span class="modal-more-name">${E(u.name)}</span>
                        </button>`).join("")}
                </div>
            </div>`:"";s.innerHTML=`
        <div class="modal-backdrop"></div>
        <div class="modal-content" role="document">
            <div class="modal-drag-handle" aria-hidden="true"></div>
            <button type="button" class="modal-close" aria-label="Close dialog">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M4 4l8 8M12 4l-8 8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
            </button>
            <div class="modal-header">
                <div class="modal-icon-container">
                    <img src="${y(n.icon)}" alt="${y(n.name)} icon"
                         class="modal-icon" width="88" height="88">
                </div>
                <div class="modal-title-block">
                    <h2 class="modal-title">${E(n.name)}</h2>
                    <p class="modal-developer">${E(n.developer)}</p>
                    <div class="modal-meta">
                        <span class="modal-meta-item">v${E(n.version)}</span>
                        <span class="modal-meta-sep" aria-hidden="true">&bull;</span>
                        <span class="modal-meta-item">${E(n.size)}</span>
                        <span class="modal-meta-sep" aria-hidden="true">&bull;</span>
                        <span class="modal-meta-item">iOS ${E(n.minimumOS)}+</span>
                    </div>
                </div>
            </div>
            ${i}
            <div class="modal-body">
                <p class="modal-description">${E(n.description)}</p>
                ${l}
                ${c}
                <p class="modal-date">Updated ${E(n.date)}</p>
            </div>
            ${p}
            <div class="modal-footer">
                <div class="modal-action-row">
                    ${"share"in navigator?`<button type="button" class="modal-action-btn modal-share-btn" aria-label="Share ${y(n.name)}">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M8 2v8M4 6l4-4 4 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M2 10v3a1 1 0 001 1h10a1 1 0 001-1v-3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
                        Share
                    </button>`:""}
                    <button type="button" class="modal-action-btn modal-copy-btn" aria-label="Copy link to ${y(n.name)}">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M6 6H4a2 2 0 00-2 2v4a2 2 0 002 2h4a2 2 0 002-2v-2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><rect x="6" y="2" width="8" height="8" rx="2" stroke="currentColor" stroke-width="1.5"/></svg>
                        Copy Link
                    </button>
                </div>
                <button type="button" class="modal-download-btn" data-id="${y(n.id)}" aria-label="Download ${y(n.name)} IPA">
                    Download IPA
                </button>
            </div>
        </div>
    `,document.body.appendChild(s),P=s;const f=s.querySelector(".modal-content");f&&(f.style.setProperty("--modal-tint",n.tintColor),f.style.setProperty("--modal-tint-glow",I(n.tintColor,.12)));const g=s.querySelector(".modal-icon");g&&g.addEventListener("error",()=>{g.src=m.FALLBACK_ICON},{once:!0}),s.querySelectorAll(".modal-screenshot").forEach(u=>{u.addEventListener("error",()=>{u.style.display="none"},{once:!0})}),document.body.classList.add("modal-open"),document.body.style.top=`-${e.modalScrollY}px`,s.offsetHeight,s.classList.add("active");const v=s.querySelector(".modal-close");v?.focus(),Ne(s),N?.(),N=He(s),s.querySelector(".modal-backdrop")?.addEventListener("click",()=>k(!1,e)),v?.addEventListener("click",()=>k(!1,e)),s.querySelector(".modal-download-btn")?.addEventListener("click",()=>{Y(n.id,e.apps,e.isOnline)}),s.querySelector(".modal-share-btn")?.addEventListener("click",async()=>{const u=`${m.BASE_URL}#app-${encodeURIComponent(n.bundleId)}`;try{await navigator.share({title:`${n.name} ‚Äî Mini's Repo`,text:`Get ${n.name} (v${n.version}) from Mini's IPA Repo`,url:u})}catch(h){h.name!=="AbortError"&&w("Share failed","warning")}});const b=s.querySelector(".modal-copy-btn");b?.addEventListener("click",async()=>{const u=`${m.BASE_URL}#app-${encodeURIComponent(n.bundleId)}`;let h=!1;try{await navigator.clipboard.writeText(u),h=!0}catch{h=Fe(u)}h?(b.classList.add("copied"),b.innerHTML='<svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M3 8l3 3 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg> Copied!',w("Link copied to clipboard","success"),setTimeout(()=>{b.classList.remove("copied"),b.innerHTML='<svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M6 6H4a2 2 0 00-2 2v4a2 2 0 002 2h4a2 2 0 002-2v-2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><rect x="6" y="2" width="8" height="8" rx="2" stroke="currentColor" stroke-width="1.5"/></svg> Copy Link'},2e3)):w("Failed to copy link","warning")}),s.querySelectorAll(".modal-more-item").forEach(u=>{u.addEventListener("click",()=>{const h=u.dataset.appId;h&&(k(!1,e),setTimeout(()=>B(h,e),400))})}),s.addEventListener("keydown",u=>{if(u.key==="Escape"){u.stopPropagation(),k(!1,e);return}u.key==="Tab"&&qe(u,s)})}function k(t,e){const r=P;if(!r||!e.modalOpen)return;e.modalOpen=!1,N?.(),N=null,r.classList.remove("active");const n=document.getElementById("themeColor");n&&(n.content="#000000"),document.body.classList.remove("modal-open"),document.body.style.top="",window.scrollTo({top:e.modalScrollY,behavior:"instant"}),!t&&e.modalHistoryPushed?(e.modalHistoryPushed=!1,history.back()):(e.modalHistoryPushed=!1,ae(null,!1,e));const o=e.lastOpenedCardId;e.lastOpenedCardId=null,setTimeout(()=>{r.remove(),P=null},350),o&&document.querySelector(`.app-card[data-app-id="${CSS.escape(o)}"]`)?.focus({preventScroll:!0})}function ae(t,e,r){if(t){const n=`#app-${encodeURIComponent(t)}`;e?(history.replaceState({appModal:!0},"",n),r.modalHistoryPushed=!1):(history.pushState({appModal:!0},"",n),r.modalHistoryPushed=!0)}else history.replaceState(null,"",window.location.pathname+window.location.search)}function ce(t){const e=window.location.hash;if(e&&e.startsWith("#app-")){const r=decodeURIComponent(e.substring(5)),n=t.apps.find(o=>o.bundleId===r||o.id===r);n&&setTimeout(()=>B(n.id,t,!0),100)}}function Pe(t){window.addEventListener("popstate",()=>{t.modalOpen&&!window.location.hash?(t.modalHistoryPushed=!1,k(!0,t)):window.location.hash?.startsWith("#app-")&&ce(t)})}function Ne(t){const e=t.querySelector(".modal-screenshots-track"),r=t.querySelectorAll(".modal-dot");if(!e||r.length===0)return;const n=e.parentElement;if(!n)return;n.setAttribute("tabindex","0"),n.setAttribute("role","listbox"),n.setAttribute("aria-label","Screenshot carousel, use arrow keys to navigate");let o=0;const s=i=>{o=i,r.forEach((c,l)=>{c.classList.toggle("active",l===o)})};n.addEventListener("scroll",()=>{const i=n.scrollLeft,c=e.querySelectorAll(".modal-screenshot");if(c.length===0)return;const l=c[0].offsetWidth+12,d=Math.round(i/l);d!==o&&s(d)},{passive:!0}),n.addEventListener("keydown",i=>{if(i.key!=="ArrowLeft"&&i.key!=="ArrowRight")return;i.preventDefault();const c=e.querySelectorAll(".modal-screenshot");if(c.length===0)return;const l=c[0].offsetWidth+12;i.key==="ArrowRight"?o=Math.min(o+1,c.length-1):o=Math.max(o-1,0),n.scrollTo({left:o*l,behavior:"smooth"}),s(o)})}function He(t){const e=t.querySelector(".modal-icon");if(!e)return null;const r=s=>{const i=e.getBoundingClientRect(),c=i.left+i.width/2,l=i.top+i.height/2,d=(s.clientX-c)/(i.width/2),f=(s.clientY-l)/(i.height/2)*-8,g=d*8;e.style.transform=`perspective(200px) rotateX(${f}deg) rotateY(${g}deg)`},n=()=>{e.style.transform=""};t.addEventListener("mousemove",r),t.addEventListener("mouseleave",n);let o=null;return"DeviceOrientationEvent"in window&&(o=s=>{const i=(s.beta??0)/90,c=(s.gamma??0)/90;e.style.transform=`perspective(200px) rotateX(${i*-10}deg) rotateY(${c*10}deg)`},window.addEventListener("deviceorientation",o,{passive:!0})),()=>{t.removeEventListener("mousemove",r),t.removeEventListener("mouseleave",n),o&&(window.removeEventListener("deviceorientation",o),o=null),e.style.transform=""}}function Ue(t){const e=[t.icon,...t.screenshots].filter(Boolean),r=new Set;document.querySelectorAll('link[rel="preload"][as="image"]').forEach(n=>{r.add(n.href)});for(const n of e){let o;try{o=new URL(n,window.location.href).href}catch{continue}if(r.has(o))continue;const s=document.createElement("link");s.rel="preload",s.as="image",s.href=n,document.head.appendChild(s),setTimeout(()=>s.remove(),3e4)}}function qe(t,e){const r=e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(r.length===0)return;const n=r[0],o=r[r.length-1];t.shiftKey&&document.activeElement===n?(t.preventDefault(),o.focus()):!t.shiftKey&&document.activeElement===o&&(t.preventDefault(),n.focus())}function Fe(t){try{const e=document.createElement("textarea");e.value=t,e.style.cssText="position:fixed;left:-9999px;opacity:0",document.body.appendChild(e),e.select();const r=document.execCommand("copy");return document.body.removeChild(e),r}catch{return!1}}const We=`
attribute vec2 a_pos;
void main() { gl_Position = vec4(a_pos, 0.0, 1.0); }
`,ze=`
precision mediump float;
uniform float u_time;
uniform vec2 u_res;

vec3 pal(float t) {
    vec3 a = vec3(0.486, 0.227, 0.918);
    vec3 b = vec3(0.165, 0.118, 0.353);
    vec3 c = vec3(0.659, 0.333, 0.969);
    return a + b * cos(6.283 * (c * t + vec3(0.0, 0.33, 0.67)));
}

float hash(vec2 p) {
    return fract(sin(dot(p, vec2(127.1, 311.7))) * 43758.5453);
}

float noise(vec2 p) {
    vec2 i = floor(p);
    vec2 f = fract(p);
    f = f * f * (3.0 - 2.0 * f);
    return mix(
        mix(hash(i), hash(i + vec2(1.0, 0.0)), f.x),
        mix(hash(i + vec2(0.0, 1.0)), hash(i + vec2(1.0, 1.0)), f.x),
        f.y
    );
}

void main() {
    vec2 uv = gl_FragCoord.xy / u_res;
    float t = u_time * 0.08;
    float n = noise(uv * 3.0 + t);
    vec3 c1 = pal(uv.x * 0.4 + n * 0.3 + t);
    vec3 c2 = pal(length(uv - 0.5) * 0.6 + t * 0.7);
    vec3 col = mix(c1, c2, n * 0.5 + 0.25);
    float fade = smoothstep(1.2, 0.0, length(uv - vec2(0.5, 0.3)) * 1.5);
    gl_FragColor = vec4(col * fade * 0.3, 1.0);
}
`;function Ge(t){const e=t.getContext("webgl",{alpha:!1,antialias:!1,powerPreference:"low-power"});if(!e)return null;const r=Z(e,e.VERTEX_SHADER,We),n=Z(e,e.FRAGMENT_SHADER,ze);if(!r||!n)return null;const o=e.createProgram();if(e.attachShader(o,r),e.attachShader(o,n),e.linkProgram(o),!e.getProgramParameter(o,e.LINK_STATUS))return console.warn("[HeroGL] Link failed:",e.getProgramInfoLog(o)),null;e.useProgram(o);const s=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,s),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,1]),e.STATIC_DRAW);const i=e.getAttribLocation(o,"a_pos");e.enableVertexAttribArray(i),e.vertexAttribPointer(i,2,e.FLOAT,!1,0,0);const c=e.getUniformLocation(o,"u_time"),l=e.getUniformLocation(o,"u_res");let d=!0,p=0;function f(){const v=Math.min(window.devicePixelRatio,1.5),b=t.clientWidth*v,u=t.clientHeight*v;(t.width!==b||t.height!==u)&&(t.width=b,t.height=u,e.viewport(0,0,b,u))}function g(v){d&&(p++,p%2===0&&(f(),e.uniform1f(c,v*.001),e.uniform2f(l,t.width,t.height),e.drawArrays(e.TRIANGLE_STRIP,0,4)),requestAnimationFrame(g))}return f(),requestAnimationFrame(g),()=>{d=!1,e.deleteProgram(o),e.deleteShader(r),e.deleteShader(n),e.deleteBuffer(s)}}function Z(t,e,r){const n=t.createShader(e);return t.shaderSource(n,r),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:(console.warn("[HeroGL] Shader error:",t.getShaderInfoLog(n)),t.deleteShader(n),null)}let O=null,W=null;function je(t,e){if(!("serviceWorker"in navigator))return;const r=()=>{navigator.serviceWorker.register("./sw.js").then(o=>{o.addEventListener("updatefound",()=>{O=o.installing,O?.addEventListener("statechange",()=>{O?.state==="installed"&&navigator.serviceWorker.controller&&Ye()})}),W=setInterval(()=>{o.update().catch(()=>{})},m.SW_UPDATE_INTERVAL),"sync"in o&&o.sync.register("sync-data").catch(()=>{})}).catch(o=>console.error("SW registration failed:",o))};document.readyState==="complete"?r():window.addEventListener("load",r,{once:!0});let n=!1;navigator.serviceWorker.addEventListener("controllerchange",()=>{n||(n=!0,window.location.reload())}),navigator.serviceWorker.addEventListener("message",o=>{o.data?.type==="DATA_UPDATED"&&e()})}function Ye(){w("New version available!","info",{text:"REFRESH",callback:()=>{O?.postMessage({action:"skipWaiting"})}})}function Ve(t){window.addEventListener("beforeinstallprompt",n=>{n.preventDefault(),t.deferredInstallPrompt=n,Ke()}),window.addEventListener("appinstalled",()=>{t.deferredInstallPrompt=null,z(),w("App installed successfully!","success");try{const n=parseInt(localStorage.getItem("install_count")??"0",10);localStorage.setItem("install_count",String(n+1)),localStorage.setItem("installed_at",new Date().toISOString())}catch{}}),window.matchMedia("(display-mode: standalone)").matches&&document.body.classList.add("pwa-installed"),document.getElementById("btn-install")?.addEventListener("click",Xe),document.getElementById("btn-install-dismiss")?.addEventListener("click",z)}function Ke(){const t=document.getElementById("installBanner");t&&(t.removeAttribute("hidden"),requestAnimationFrame(()=>requestAnimationFrame(()=>t.classList.add("visible"))))}function z(){const t=document.getElementById("installBanner");t&&(t.classList.remove("visible"),setTimeout(()=>t.setAttribute("hidden",""),400))}async function Xe(){const t=window.__state?.deferredInstallPrompt;t&&(t.prompt(),await t.userChoice,z())}function Ze(t){const e=document.getElementById("offlineBar");function r(){t.isOnline=navigator.onLine,e&&(t.isOnline?(e.classList.remove("visible"),setTimeout(()=>e.setAttribute("hidden",""),350)):(e.removeAttribute("hidden"),requestAnimationFrame(()=>requestAnimationFrame(()=>e.classList.add("visible"))))),document.querySelectorAll(".card-get-btn").forEach(n=>{n.classList.toggle("offline-disabled",!t.isOnline)})}window.addEventListener("online",()=>{r(),w("Back online","success")},{passive:!0}),window.addEventListener("offline",()=>{r(),w("You are offline","warning")},{passive:!0}),r()}function Je(t){if(!("setAppBadge"in navigator))return;const e=Date.now(),r=1440*60*1e3,n=t.filter(o=>{const s=new Date(o.date+"T00:00:00Z").getTime();return e-s<r}).length;n>0?navigator.setAppBadge(n).catch(()=>{}):navigator.clearAppBadge?.().catch(()=>{})}function Qe(){W&&clearInterval(W)}async function et(){try{if(localStorage.clear(),"caches"in window){const t=await caches.keys();await Promise.all(t.map(e=>caches.delete(e)))}indexedDB.deleteDatabase("minis-repo")}catch{}window.location.reload()}const a={apps:[],filteredApps:[],searchTerm:"",activeCategory:"all",sortMode:"recent",isLoading:!0,isOnline:navigator.onLine,modalOpen:!1,modalScrollY:0,lastOpenedCardId:null,modalHistoryPushed:!1,deferredInstallPrompt:null,toastTimer:null,renderGeneration:0,recentSearches:[],searchOverlayOpen:!1,developerIndex:new Map};window.__state=a;let V=null,G=null,$=[],J="",Q="all",ee="recent";document.addEventListener("DOMContentLoaded",async()=>{try{ht(),pt(),je(a,dt),Ve(a),Ze(a),Pe(a),ct(),(window.requestIdleCallback??(r=>setTimeout(r,0)))(()=>rt());const e=await Se("searches","recent");e&&(a.recentSearches=e),a.apps=await le(),a.isLoading=!1,de(),a.apps.length===0?te("No apps available in this repository"):(he(a.apps.length),ot(),ue(),De(a.apps),nt(),L(!0),ce(a),Je(a.apps),at())}catch(t){console.error("Initialization error:",t),te(t.message??"Failed to initialize")}});async function le(){const t=new AbortController,e=setTimeout(()=>t.abort(),m.FETCH_TIMEOUT),r=document.getElementById("appGrid");r&&r.setAttribute("aria-busy","true");try{const n=await fetch(m.API_ENDPOINT,{signal:t.signal,cache:"no-cache"});if(clearTimeout(e),!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);let o;try{o=await n.json()}catch{throw new Error("Data corruption: Unable to parse app manifest.")}if(!o?.apps||!Array.isArray(o.apps))throw new Error("Invalid manifest structure");return o.apps.filter(s=>s.versions?.length>0).map((s,i)=>{const c=s.versions[0],l=Ce(s.bundleIdentifier??"");return{id:Le(s.bundleIdentifier,i),name:s.name??"Unknown App",bundleId:s.bundleIdentifier??"",developer:s.developerName??"Unknown",description:s.localizedDescription??"",icon:s.iconURL??m.FALLBACK_ICON,version:c.version??"Unknown",date:c.date??"",downloadUrl:c.downloadURL??"",category:l,size:be(c.size),sizeBytes:c.size??0,changelog:c.localizedDescription??"",tintColor:we(s.tintColor),subtitle:s.subtitle??"",minimumOS:c.minOSVersion??"15.0",permissions:Te(s.permissions??[]),screenshots:s.screenshotURLs??[],_searchName:(s.name??"").toLowerCase(),_searchDev:(s.developerName??"").toLowerCase(),_searchDesc:(s.localizedDescription??"").toLowerCase(),_wordStartsName:M((s.name??"").toLowerCase()),_wordStartsDev:M((s.developerName??"").toLowerCase()),_wordStartsDesc:M((s.localizedDescription??"").toLowerCase())}})}catch(n){throw n.name==="AbortError"?new Error("Request timeout ‚Äî please check your connection"):n}finally{clearTimeout(e),r&&r.removeAttribute("aria-busy")}}function de(){a.developerIndex=new Map;for(const t of a.apps){const e=a.developerIndex.get(t.developer);e?e.push(t):a.developerIndex.set(t.developer,[t])}}function L(t=!1){!t&&a.searchTerm===J&&a.activeCategory===Q&&a.sortMode===ee||(J=a.searchTerm,Q=a.activeCategory,ee=a.sortMode,a.renderGeneration++,a.searchTerm?($=oe(a.searchTerm,a.apps).filter(r=>a.activeCategory==="all"||r.app.category===a.activeCategory),a.filteredApps=$.map(r=>r.app)):($=[],a.filteredApps=a.apps.filter(e=>a.activeCategory==="all"||e.category===a.activeCategory)),a.searchTerm||(a.sortMode==="alpha"?a.filteredApps.sort((e,r)=>e.name.localeCompare(r.name)):a.filteredApps.sort((e,r)=>r.date>e.date?1:r.date<e.date?-1:0)),V?.setItems(a.filteredApps),tt())}function tt(){const t=document.getElementById("searchResultsCount");if(!t)return;const e=a.filteredApps.length,r=a.apps.length;!a.searchTerm&&a.activeCategory==="all"?t.textContent=`${r} apps available, showing all ${e}`:e===0?t.textContent="No apps found":t.textContent=`${r} apps available, filtered to ${e}`}function nt(){const t=document.getElementById("appGrid");t&&(t.innerHTML="",V=new Re(t,{createCardNode:Me,bindCard:(e,r,n)=>{const o=$.find(s=>s.app.id===r.id);Oe(e,r,n,o?.nameMatches)},onCardClick:e=>B(e,a)}),t.addEventListener("click",e=>{const r=e.target.closest(".card-get-btn");if(r){e.stopPropagation();const n=r.dataset.id;n&&Y(n,a.apps,a.isOnline)}}))}function ot(){const t=a.apps.find(o=>o.bundleId===m.FEATURED_BUNDLE_ID);if(!t)return;const e=document.getElementById("featuredSection"),r=document.getElementById("featuredCard");if(!e||!r)return;_e(t,e,r,o=>B(o,a)),r.querySelector(".featured-get-btn")?.addEventListener("click",o=>{o.stopPropagation(),Y(t.id,a.apps,a.isOnline)})}function rt(){const t=document.getElementById("heroCanvas");t&&(G=Ge(t),G&&t.classList.add("active"))}function ue(){const t={all:a.apps.length};for(const e of a.apps)t[e.category]=(t[e.category]||0)+1;document.querySelectorAll(".category-pill").forEach(e=>{const r=e.dataset.category;if(!r)return;const n=t[r];if(n===void 0)return;let o=e.querySelector(".category-count");o||(o=document.createElement("span"),o.className="category-count",o.setAttribute("aria-hidden","true"),e.appendChild(o)),o.textContent=String(n)})}function he(t){const e=document.getElementById("appCountText");e&&(e.textContent=`${t} Apps`)}function q(){a.searchOverlayOpen=!0;const t=document.getElementById("searchOverlay"),e=document.getElementById("searchOverlayInput");!t||!e||(t.classList.add("active"),document.body.classList.add("search-overlay-open"),e.value=a.searchTerm,e.focus(),st(),_())}function T(){a.searchOverlayOpen=!1;const t=document.getElementById("searchOverlay");if(!t)return;document.getElementById("searchOverlayInput")?.blur(),t.classList.remove("active"),document.body.classList.remove("search-overlay-open");const r=document.getElementById("searchOverlayResults");r&&(r.innerHTML=""),document.getElementById("recentSearches")?.classList.remove("hidden");const n=document.getElementById("searchBox");n&&(n.value=a.searchTerm,n.placeholder=a.searchTerm?"":"Search apps..."),pe()}function st(){const t=document.getElementById("recentSearches");if(t){if(a.recentSearches.length===0){t.innerHTML="";return}t.innerHTML=a.recentSearches.map(e=>`<button type="button" class="recent-search-pill" data-term="${e.replace(/"/g,"&quot;")}">${e.replace(/</g,"&lt;")}</button>`).join("")}}function pe(){const t=document.getElementById("searchClearBtn"),e=document.querySelector(".search-shortcut");t&&t.classList.toggle("visible",a.searchTerm.length>0),e&&(e.style.display=a.searchTerm.length>0?"none":"")}function it(){a.searchTerm="";const t=document.getElementById("searchBox");t&&(t.value="",t.placeholder="Search apps..."),L(),pe()}function x(t){!t||t.length<2||(a.recentSearches=[t,...a.recentSearches.filter(e=>e!==t)].slice(0,m.MAX_RECENT_SEARCHES),ke("searches","recent",a.recentSearches).catch(()=>{}))}function _(){const t=document.getElementById("searchOverlayResults"),e=document.getElementById("recentSearches");if(!t)return;const r=a.searchTerm;if(!r){t.innerHTML="",e?.classList.remove("hidden");return}e?.classList.add("hidden");const n=oe(r,a.apps).filter(i=>a.activeCategory==="all"||i.app.category===a.activeCategory);if(n.length===0){t.innerHTML=`
            <div class="search-overlay-no-results">
                <div class="search-overlay-no-results-icon" aria-hidden="true">üîç</div>
                <p>No apps found for "<strong>${r.replace(/</g,"&lt;")}</strong>"</p>
            </div>`;return}const o=20,s=n.slice(0,o);t.innerHTML=s.map(i=>{const c=re(i.app.name,i.nameMatches),l=i.app.developer.replace(/</g,"&lt;");return`<button type="button" class="search-result-item" data-app-id="${i.app.id}" role="option">
            <img class="search-result-icon" src="${i.app.icon}" alt="" width="44" height="44" loading="lazy" />
            <div class="search-result-info">
                <div class="search-result-name">${c}</div>
                <div class="search-result-dev">${l}</div>
            </div>
            <span class="search-result-get" aria-hidden="true">GET</span>
        </button>`}).join(""),n.length>o&&t.insertAdjacentHTML("beforeend",`<div class="search-overlay-no-results" style="padding:var(--s3) var(--s4);font-size:0.8em;">
                and ${n.length-o} more‚Ä¶
            </div>`)}function at(){const t=document.getElementById("scrollTopBtn"),e=document.querySelector(".hero");if(!t||!e)return;new IntersectionObserver(n=>{const o=n[0].isIntersecting;t.classList.toggle("visible",!o),t.setAttribute("aria-hidden",String(o))},{threshold:0}).observe(e),t.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})})}function ct(){const t=document.getElementById("appGrid");t&&(t.setAttribute("aria-busy","true"),t.innerHTML=Array(6).fill(0).map((e,r)=>`
        <div class="skeleton-card stagger-${r%3+1}" aria-hidden="true">
            <div class="skeleton skeleton-icon"></div>
            <div class="skeleton-lines">
                <div class="skeleton skeleton-text short"></div>
                <div class="skeleton skeleton-text medium"></div>
            </div>
            <div class="skeleton skeleton-button"></div>
        </div>`).join(""))}function te(t){const e=document.getElementById("appGrid");if(!e)return;e.removeAttribute("aria-busy"),e.innerHTML=`
        <div class="error-state">
            <div class="error-icon" aria-hidden="true">
                <svg width="48" height="48" viewBox="0 0 48 48" fill="none"><circle cx="24" cy="24" r="22" stroke="currentColor" stroke-width="2"/><path d="M24 14v12M24 32v2" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/></svg>
            </div>
            <h3>Something went wrong</h3>
            <p></p>
            <button type="button" class="retry-btn" onclick="location.reload()">Try Again</button>
        </div>
    `;const r=e.querySelector(".error-state p");r&&(r.textContent=String(t))}let ne=0;const lt=1e4;async function dt(){const t=Date.now();if(!(t-ne<lt)){ne=t;try{const e=await le();a.apps=e,de(),he(e.length),ue(),L(!0),w("App list updated","info")}catch{}}}async function ut(){const t=document.getElementById("btn-copy-url"),e=document.getElementById("copyUrlLabel");try{await navigator.clipboard.writeText(m.MANIFEST_URL)}catch{const r=document.createElement("textarea");r.value=m.MANIFEST_URL,r.style.cssText="position:fixed;left:-9999px;opacity:0",document.body.appendChild(r),r.select(),document.execCommand("copy"),document.body.removeChild(r)}w("Manifest URL copied","success"),t&&e&&(e.textContent="Copied!",t.classList.add("copied"),setTimeout(()=>{e.textContent="Copy URL",t.classList.remove("copied")},2e3))}function ht(){const t=document.getElementById("searchBox");t?.addEventListener("focus",()=>{a.searchOverlayOpen||q(),t.blur()}),document.getElementById("searchClearBtn")?.addEventListener("click",i=>{i.stopPropagation(),it()});const e=document.getElementById("searchOverlayInput");if(e){const i=Ae(c=>{a.searchTerm=c.toLowerCase().trim(),L(),_()},m.SEARCH_DEBOUNCE);e.addEventListener("input",c=>{i(c.target.value)}),e.addEventListener("keydown",c=>{c.key==="Escape"&&(x(a.searchTerm),T()),c.key==="Enter"&&(c.preventDefault(),a.searchTerm=e.value.toLowerCase().trim(),L(),_(),x(a.searchTerm),T())})}document.getElementById("searchOverlayClose")?.addEventListener("click",()=>{x(a.searchTerm),T()}),document.getElementById("searchOverlay")?.addEventListener("click",i=>{i.target===i.currentTarget&&(x(a.searchTerm),T())}),document.getElementById("recentSearches")?.addEventListener("click",i=>{const c=i.target.closest(".recent-search-pill");if(!c)return;const l=c.dataset.term??"",d=document.getElementById("searchOverlayInput");d&&(d.value=l),a.searchTerm=l.toLowerCase(),L(),_()}),document.getElementById("searchOverlayResults")?.addEventListener("click",i=>{const c=i.target.closest(".search-result-item");if(!c)return;const l=c.dataset.appId;l&&(x(a.searchTerm),T(),B(l,a))}),document.addEventListener("keydown",i=>{if((i.metaKey||i.ctrlKey)&&i.key==="k"){i.preventDefault(),q();return}if(i.key==="/"&&!a.modalOpen&&!a.searchOverlayOpen){const c=document.activeElement;c instanceof HTMLInputElement||c instanceof HTMLTextAreaElement||c?.isContentEditable||(i.preventDefault(),q())}i.key==="Escape"&&a.modalOpen&&k(!1,a)});const r=document.getElementById("categoryFilters");r&&(r.addEventListener("click",i=>{const c=i.target.closest(".category-pill");if(!c)return;const l=c.getBoundingClientRect(),d=document.createElement("span");d.className="pill-ripple",d.style.left=`${i.clientX-l.left}px`,d.style.top=`${i.clientY-l.top}px`,c.appendChild(d),d.addEventListener("animationend",()=>d.remove());const p=c.dataset.category;a.activeCategory=p===a.activeCategory&&p!=="all"?"all":p,r.querySelectorAll(".category-pill").forEach(f=>{const g=f.dataset.category===a.activeCategory;f.classList.toggle("active",g),f.setAttribute("aria-selected",String(g)),f.setAttribute("tabindex",g?"0":"-1")}),L()}),r.addEventListener("keydown",i=>{if(i.key==="ArrowRight"||i.key==="ArrowLeft"){i.preventDefault();const c=Array.from(r.querySelectorAll(".category-pill")),l=c.indexOf(document.activeElement);if(l===-1)return;const d=i.key==="ArrowRight"?Math.min(l+1,c.length-1):Math.max(l-1,0);c[d].focus()}}));const n=document.getElementById("sortRecent"),o=document.getElementById("sortAlpha");function s(i){a.sortMode=i,n?.classList.toggle("active",i==="recent"),n?.setAttribute("aria-pressed",String(i==="recent")),o?.classList.toggle("active",i==="alpha"),o?.setAttribute("aria-pressed",String(i==="alpha")),L()}n?.addEventListener("click",()=>s("recent")),o?.addEventListener("click",()=>s("alpha")),document.getElementById("btn-trollapps")?.addEventListener("click",()=>{window.location.href=`trollapps://add?url=${encodeURIComponent(m.API_ENDPOINT)}`}),document.getElementById("btn-sidestore")?.addEventListener("click",()=>{window.location.href=`sidestore://source?url=${encodeURIComponent(m.API_ENDPOINT)}`}),document.getElementById("btn-copy-url")?.addEventListener("click",ut),document.getElementById("btn-reset")?.addEventListener("click",async()=>{confirm("Reset all local data and cache?")&&await et()})}function pt(){window.addEventListener("unhandledrejection",t=>console.warn("Unhandled rejection:",t.reason)),window.addEventListener("error",t=>console.error("Global error:",t.error))}window.addEventListener("beforeunload",()=>{G?.(),V?.destroy(),Qe()});
