(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function o(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=o(r);fetch(r.href,s)}})();const X=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||window.location.hostname==="0.0.0.0"||window.location.hostname==="[::1]"),m={API_ENDPOINT:X?"./mini.json":"https://OofMini.github.io/Minis-Repo/mini.json",FALLBACK_ICON:"./apps/repo-icon.png",FEATURED_BUNDLE_ID:"com.spotify.client",SEARCH_DEBOUNCE:150,TOAST_DURATION:4e3,FETCH_TIMEOUT:1e4,CARD_POOL_SIZE:24,OVERSCAN_ROWS:3,CARD_ROW_HEIGHT:88,CARD_GAP:12,SW_UPDATE_INTERVAL:1800*1e3,MAX_RECENT_SEARCHES:5,IDB_NAME:"minis-repo",IDB_VERSION:1,SPRING_BOUNCY:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",SPRING_SMOOTH:"cubic-bezier(0.4, 0, 0.2, 1)",MANIFEST_URL:"https://OofMini.github.io/Minis-Repo/mini.json",BASE_URL:X?window.location.origin+window.location.pathname:"https://OofMini.github.io/Minis-Repo/"},Z=document.createElement("div");function w(t){return t?(Z.textContent=t,Z.innerHTML):""}function y(t){return t?String(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}const ye="#a78bfa";function we(t){return t&&/^#[0-9A-Fa-f]{6}$/.test(t)?t:ye}function I(t,e){if(!t||t.length<7)return`rgba(167, 139, 250, ${e})`;const o=parseInt(t.slice(1,3),16),n=parseInt(t.slice(3,5),16),r=parseInt(t.slice(5,7),16);return isNaN(o)||isNaN(n)||isNaN(r)?`rgba(167, 139, 250, ${e})`:`rgba(${o}, ${n}, ${r}, ${e})`}function be(t){return!t||typeof t!="number"?"Unknown":t>=1073741824?`${(t/1073741824).toFixed(1)} GB`:`${(t/1048576).toFixed(0)} MB`}function Ee(t){if(!t)return"";const e=new Date(t+"T00:00:00Z"),n=Date.now()-e.getTime(),r=Math.floor(n/864e5);return r<0?"Just now":r===0?"Today":r===1?"Yesterday":r<7?`${r}d ago`:r<30?`${Math.floor(r/7)}w ago`:r<365?`${Math.floor(r/30)}mo ago`:`${Math.floor(r/365)}y ago`}function Ce(t){const e=t.toLowerCase();return e.includes("youtubemusic")||e.includes("spotify")||e.includes("music")?"Music":e.includes("youtube")||e.includes("video")?"Video":e.includes("social")||e.includes("tweet")||e.includes("twitter")?"Social":e.includes("editor")||e.includes("inshot")||e.includes("photo")||e.includes("reface")||e.includes("doublicatapp")?"Creative":"Utilities"}function Le(t,e){return t?t.toLowerCase():`unknown-${e}`}function Ie(t){if(!t||typeof t!="string")return!1;try{const e=new URL(t);return e.protocol==="https:"&&e.hostname.length>0}catch{return!1}}function Ae(t,e){let o;const n=(...r)=>{clearTimeout(o),o=setTimeout(()=>t(...r),e)};return n.cancel=()=>clearTimeout(o),n}function Se(t,e){return new Promise(o=>{try{const n=indexedDB.open("minis-repo",1);n.onupgradeneeded=()=>{const r=n.result;r.objectStoreNames.contains("searches")||r.createObjectStore("searches",{keyPath:"key"}),r.objectStoreNames.contains("data")||r.createObjectStore("data",{keyPath:"key"})},n.onsuccess=()=>{try{const c=n.result.transaction(t,"readonly").objectStore(t).get(e);c.onsuccess=()=>o(c.result?.value),c.onerror=()=>o(void 0)}catch{o(void 0)}},n.onerror=()=>o(void 0)}catch{o(void 0)}})}function ke(t,e,o){return new Promise(n=>{try{const r=indexedDB.open("minis-repo",1);r.onupgradeneeded=()=>{const s=r.result;s.objectStoreNames.contains("searches")||s.createObjectStore("searches",{keyPath:"key"}),s.objectStoreNames.contains("data")||s.createObjectStore("data",{keyPath:"key"})},r.onsuccess=()=>{try{const s=r.result.transaction(t,"readwrite");s.objectStore(t).put({key:e,value:o}),s.oncomplete=()=>n(),s.onerror=()=>n()}catch{n()}},r.onerror=()=>n()}catch{n()}})}function Te(t){return Array.isArray(t)?t.map(e=>typeof e=="string"?{type:e,usageDescription:""}:typeof e=="object"&&e!==null&&"type"in e?{type:e.type,usageDescription:e.usageDescription??""}:null).filter(e=>e!==null):[]}function N(t,e,o,n){if(!e)return{score:0,ranges:[]};if(e===t)return{score:1*o,ranges:[[0,e.length]]};if(e.startsWith(t))return{score:.95*o,ranges:[[0,t.length]]};const r=e.indexOf(t);if(r>=0)return{score:(.8+(r===0||/\W/.test(e[r-1])?.05:0))*o,ranges:[[r,r+t.length]]};const s=n??O(e),c=xe(t,e,s);if(c)return{score:.65*o,ranges:c};const i=Be(t,e);if(i){const l=i[i.length-1][1]-i[0][0],d=t.length/Math.max(l,1);return{score:Math.min(.5,.3+d*.2)*o,ranges:i}}return{score:0,ranges:[]}}function O(t){const e=[0];for(let o=1;o<t.length;o++)/\W/.test(t[o-1])&&/\w/.test(t[o])&&e.push(o);return e}function xe(t,e,o){if(o.length<t.length)return null;const n=[];let r=0;for(let s=0;s<t.length;s++){let c=!1;for(;r<o.length;){if(e[o[r]]===t[s]){n.push([o[r],o[r]+1]),r++,c=!0;break}r++}if(!c)return null}return n}function Be(t,e){const o=[];let n=0;for(let r=0;r<t.length;r++){let s=!1;for(;n<e.length;){if(e[n]===t[r]){o.length>0&&o[o.length-1][1]===n?o[o.length-1][1]=n+1:o.push([n,n+1]),n++,s=!0;break}n++}if(!s)return null}return o}function Re(t,e){const o=t.toLowerCase().trim();if(!o)return e.map(r=>({app:r,score:1,nameMatches:[]}));const n=[];for(const r of e){const s=N(o,r._searchName,1,r._wordStartsName),c=N(o,r._searchDev,.7,r._wordStartsDev),i=N(o,r._searchDesc,.4,r._wordStartsDesc);let l=0,d=[];s.score>=c.score&&s.score>=i.score?(l=s.score,d=s.ranges):c.score>=i.score?(l=c.score,d=[]):(l=i.score,d=[]),l>0&&n.push({app:r,score:l,nameMatches:s.score>0?s.ranges:d})}return n.sort((r,s)=>s.score!==r.score?s.score-r.score:r.app.name.localeCompare(s.app.name)),n}function re(t,e){if(!e.length)return M(t);let o="",n=0;const r=[...e].sort((c,i)=>c[0]-i[0]),s=[];for(const c of r)s.length>0&&c[0]<=s[s.length-1][1]?s[s.length-1][1]=Math.max(s[s.length-1][1],c[1]):s.push([...c]);for(const[c,i]of s)n<c&&(o+=M(t.slice(n,c))),o+=`<mark>${M(t.slice(c,i))}</mark>`,n=i;return n<t.length&&(o+=M(t.slice(n))),o}function M(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}class Me{constructor(e,o){this.items=[],this.pool=[],this.activeNodes=new Map,this.columns=1,this.rowHeight=m.CARD_ROW_HEIGHT,this.gap=m.CARD_GAP,this.containerTop=0,this.rafId=0,this.resizeObserver=null,this.resizeRafId=0,this.cachedPaddingLeft=0,this.cachedPaddingRight=0,this.cachedContainerWidth=0,this.cachedAvailableWidth=0,this.cachedColWidth=0,this.container=e,this.callbacks=o,this.innerContainer=document.createElement("div"),this.innerContainer.className="vs-inner",this.innerContainer.setAttribute("role","list"),this.innerContainer.setAttribute("aria-label","App list"),this.container.appendChild(this.innerContainer);for(let n=0;n<m.CARD_POOL_SIZE;n++){const r=o.createCardNode();r.style.position="absolute",r.style.left="0",r.style.top="0",r.style.display="none",r.setAttribute("role","listitem"),this.innerContainer.appendChild(r),this.pool.push({el:r,appId:null})}this.setupListeners(),this.computeLayout()}setupListeners(){const e=()=>{this.rafId||(this.rafId=requestAnimationFrame(()=>{this.rafId=0,this.render()}))};window.addEventListener("scroll",e,{passive:!0}),this.resizeObserver=new ResizeObserver(()=>{this.resizeRafId&&cancelAnimationFrame(this.resizeRafId),this.resizeRafId=requestAnimationFrame(()=>{this.resizeRafId=0,this.computeLayout(),this.render()})}),this.resizeObserver.observe(this.container),this.innerContainer.addEventListener("click",o=>{const n=o.target.closest("[data-app-id]");if(!n||o.target.closest("button"))return;const s=n.dataset.appId;s&&this.callbacks.onCardClick(s)}),this.innerContainer.addEventListener("keydown",o=>{const n=o.target.closest("[data-app-id]");if(n){if(o.key==="Enter"||o.key===" "){o.preventDefault();const r=n.dataset.appId;r&&this.callbacks.onCardClick(r);return}["ArrowRight","ArrowLeft","ArrowDown","ArrowUp"].includes(o.key)&&(o.preventDefault(),this.navigateGrid(n,o.key))}})}navigateGrid(e,o){const n=e.dataset.appId;if(!n)return;const r=this.items.findIndex(c=>c.id===n);if(r===-1)return;let s=r;switch(o){case"ArrowRight":s=Math.min(r+1,this.items.length-1);break;case"ArrowLeft":s=Math.max(r-1,0);break;case"ArrowDown":s=Math.min(r+this.columns,this.items.length-1);break;case"ArrowUp":s=Math.max(r-this.columns,0);break}if(s!==r){const c=this.items[s];this.scrollToIndex(s),requestAnimationFrame(()=>{const i=this.activeNodes.get(c.id);i&&i.el.focus({preventScroll:!1})})}}computeLayout(){const e=getComputedStyle(this.container);this.cachedContainerWidth=this.container.clientWidth,this.cachedPaddingLeft=parseFloat(e.paddingLeft)||0,this.cachedPaddingRight=parseFloat(e.paddingRight)||0,this.cachedAvailableWidth=this.cachedContainerWidth-this.cachedPaddingLeft-this.cachedPaddingRight,this.cachedAvailableWidth>=900?this.columns=3:this.cachedAvailableWidth>=540?this.columns=2:this.columns=1;const o=e.getPropertyValue("--vs-gap")?.trim();o&&(this.gap=parseInt(o,10)||m.CARD_GAP),this.cachedColWidth=(this.cachedAvailableWidth-(this.columns-1)*this.gap)/this.columns,this.containerTop=this.container.getBoundingClientRect().top+window.scrollY}setItems(e){this.items=e;const n=Math.ceil(e.length/this.columns)*(this.rowHeight+this.gap)-this.gap;this.innerContainer.style.height=`${Math.max(n,0)}px`;for(const[r,s]of this.activeNodes)s.el.style.display="none",s.appId=null,this.pool.push(s),this.activeNodes.delete(r);this.render()}acquireNode(){if(this.pool.length>0)return this.pool.pop()}releaseNode(e){e.appId&&this.activeNodes.delete(e.appId),e.el.style.display="none",e.appId=null,this.pool.push(e)}render(){if(this.items.length===0){for(const[,p]of this.activeNodes)this.releaseNode(p);return}const e=window.scrollY,o=window.innerHeight,n=o*2,r=this.containerTop,s=this.rowHeight+this.gap,c=Math.ceil(this.items.length/this.columns),i=e-r-n,l=e+o-r+n,d=Math.max(0,Math.floor(i/s)),h=Math.min(c-1,Math.ceil(l/s)),g=d*this.columns,f=Math.min((h+1)*this.columns,this.items.length),v=new Set;for(let p=g;p<f;p++)v.add(this.items[p].id);for(const[p,S]of this.activeNodes)v.has(p)||this.releaseNode(S);const E=this.cachedPaddingLeft,u=this.cachedColWidth;for(let p=g;p<f;p++){const S=this.items[p];let C=this.activeNodes.get(S.id);if(!C){if(C=this.acquireNode(),!C)continue;C.appId=S.id,this.activeNodes.set(S.id,C),this.callbacks.bindCard(C.el,S,p)}const me=Math.floor(p/this.columns),fe=p%this.columns,ge=E+fe*(u+this.gap),ve=me*s;C.el.style.transform=`translate3d(${ge}px, ${ve}px, 0)`,C.el.style.width=`${u}px`,C.el.style.height=`${this.rowHeight}px`,C.el.style.display=""}}scrollToIndex(e){const o=Math.floor(e/this.columns),n=this.rowHeight+this.gap,r=this.containerTop+o*n,s=window.innerHeight;(r<window.scrollY||r+this.rowHeight>window.scrollY+s)&&window.scrollTo({top:r-s/3,behavior:"smooth"}),requestAnimationFrame(()=>this.render())}setRowHeight(e){if(e>0&&e!==this.rowHeight){this.rowHeight=e;const n=Math.ceil(this.items.length/this.columns)*(this.rowHeight+this.gap)-this.gap;this.innerContainer.style.height=`${Math.max(n,0)}px`,this.render()}}getActiveNodeCount(){return this.activeNodes.size}destroy(){this.rafId&&cancelAnimationFrame(this.rafId),this.resizeRafId&&cancelAnimationFrame(this.resizeRafId),this.resizeObserver?.disconnect(),this.innerContainer.remove()}}let H=null,A=null,_=[],Y=!1;function se(){return H||(H=document.getElementById("toast")),H}function b(t,e="info",o){const n=se();if(n){if(Y){_.push({msg:t,type:e,action:o}),_.length>2&&q();return}ie(n,t,e,o)}}function ie(t,e,o,n){Y=!0,A&&(clearTimeout(A),A=null),t.innerHTML="";const r=document.createElement("span");if(r.textContent=e,t.appendChild(r),n){const s=document.createElement("button");s.type="button",s.textContent=n.text,s.addEventListener("click",()=>{n.callback(),q()}),t.appendChild(s)}t.setAttribute("aria-live",o==="error"||o==="warning"?"assertive":"polite"),t.className=`toast ${o} show`,A=setTimeout(()=>{q()},m.TOAST_DURATION)}function q(){const t=se();if(t&&(t.classList.remove("show"),Y=!1,A&&(clearTimeout(A),A=null),_.length>0)){const e=_.shift();setTimeout(()=>{ie(t,e.msg,e.type,e.action)},300)}}function Oe(){const t=document.createElement("article");return t.className="app-card",t.tabIndex=0,t.innerHTML=`
        <div class="card-accent" aria-hidden="true"></div>
        <div class="card-body">
            <div class="card-icon-wrap">
                <img class="card-icon" width="64" height="64" loading="lazy" decoding="async" alt="">
                <span class="card-version-badge" aria-hidden="true"></span>
            </div>
            <div class="card-info">
                <h3 class="card-name"></h3>
                <p class="card-developer"></p>
                <p class="card-meta"></p>
            </div>
            <button type="button" class="card-get-btn" aria-label="">
                <span class="card-get-text">GET</span>
                <span class="card-get-spinner" aria-hidden="true"></span>
                <span class="card-get-check" aria-hidden="true"></span>
            </button>
        </div>
        <div class="card-separator" aria-hidden="true"></div>
    `,t}function $e(t,e,o,n){t.dataset.appId=e.id,t.setAttribute("aria-label",`${e.name} by ${e.developer} ‚Äî tap to view details`),t.style.setProperty("--tint",e.tintColor),t.style.setProperty("--tint-10",I(e.tintColor,.1)),t.style.setProperty("--tint-20",I(e.tintColor,.2)),t.style.setProperty("--tint-40",I(e.tintColor,.4));const r=t.querySelector(".card-accent");r&&(r.style.backgroundColor=e.tintColor);const s=t.querySelector(".card-icon");s&&s.src!==e.icon&&!s.src.endsWith(e.icon)&&(s.src=e.icon,s.alt=`${e.name} icon`,s.onerror=()=>{s.src=m.FALLBACK_ICON});const c=t.querySelector(".card-version-badge");c&&(c.textContent=`v${e.version}`);const i=t.querySelector(".card-name");i&&(n&&n.length>0?i.innerHTML=re(e.name,n):i.textContent=e.name);const l=t.querySelector(".card-developer");l&&(l.textContent=e.developer);const d=t.querySelector(".card-meta");d&&(d.textContent=`${e.size} ¬∑ ${Ee(e.date)}`);const h=t.querySelector(".card-get-btn");if(h){h.dataset.id=e.id,h.setAttribute("aria-label",`Download ${e.name}`),h.className="card-get-btn",h.style.setProperty("--btn-tint",e.tintColor),h.style.setProperty("--btn-tint-bg",I(e.tintColor,.12));const g=h.querySelector(".card-get-text");g&&(g.style.display="");const f=h.querySelector(".card-get-spinner");f&&(f.style.display="none");const v=h.querySelector(".card-get-check");v&&(v.style.display="none")}}function V(t,e,o){const n=e.find(c=>c.id===t);if(!n)return;if(!o){b("You are offline. Downloads require a connection.","warning");return}if(!Ie(n.downloadUrl)){b("Security Block: URL must be HTTPS","error");return}const r=document.querySelector(`.card-get-btn[data-id="${CSS.escape(t)}"]`);r&&_e(r);const s=document.createElement("a");s.href=n.downloadUrl,s.target="_blank",s.rel="noopener noreferrer",s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s),b(`Downloading ${n.name}`,"success")}function _e(t){const e=t.querySelector(".card-get-text"),o=t.querySelector(".card-get-spinner"),n=t.querySelector(".card-get-check");!e||!o||!n||(t.classList.add("downloading"),e.style.display="none",o.style.display="",setTimeout(()=>{o.style.display="none",n.style.display="",t.classList.remove("downloading"),t.classList.add("downloaded"),setTimeout(()=>{t.classList.remove("downloaded"),e.style.display="",n.style.display="none"},2e3)},800))}function De(t,e,o,n){const r=o.querySelector(".featured-icon"),s=o.querySelector(".featured-name"),c=o.querySelector(".featured-dev"),i=o.querySelector(".featured-desc"),l=o.querySelector(".featured-get-btn");r&&(r.src=t.icon,r.alt=`${t.name} icon`,r.onerror=()=>{r.src=m.FALLBACK_ICON}),s&&(s.textContent=t.name),c&&(c.textContent=t.developer),i&&(i.textContent=t.description),l&&(l.dataset.id=t.id,l.setAttribute("aria-label",`Download ${t.name}`),l.style.setProperty("--btn-tint",t.tintColor)),o.style.setProperty("--tint",t.tintColor),o.style.setProperty("--tint-10",I(t.tintColor,.1)),o.style.setProperty("--tint-20",I(t.tintColor,.2)),o.setAttribute("data-app-id",t.id),o.setAttribute("aria-label",`${t.name} ‚Äî featured app, tap to view details`),e.removeAttribute("hidden"),e.classList.add("visible"),o.addEventListener("click",d=>{d.target.closest("button")||n(t.id)}),o.addEventListener("keydown",d=>{(d.key==="Enter"||d.key===" ")&&(d.preventDefault(),n(t.id))})}function Pe(t){const e=document.createElement("link");e.rel="preconnect",e.href="https://objects.githubusercontent.com",e.crossOrigin="anonymous",document.head.appendChild(e);const o=Math.min(6,t.length);for(let n=0;n<o;n++){const r=document.createElement("link");r.rel="preload",r.as="image",r.href=t[n].icon,n<3&&r.setAttribute("fetchpriority","high"),document.head.appendChild(r)}}let D=null,P=null;function R(t,e,o=!1){const n=e.apps.find(u=>u.id===t);if(!n||e.modalOpen)return;e.modalOpen=!0,e.modalScrollY=window.scrollY,e.lastOpenedCardId=t,qe(n),D?.remove(),ae(n.bundleId,o,e);const r=document.getElementById("themeColor");r&&(r.content="#0a0a0f");const s=document.createElement("div");s.id="appModal",s.className="modal-overlay",s.setAttribute("role","dialog"),s.setAttribute("aria-modal","true"),s.setAttribute("aria-label",`${n.name} details`);const c=n.screenshots.length>0?`<div class="modal-screenshots" role="region" aria-label="Screenshots">
                <div class="modal-screenshots-track">
                    ${n.screenshots.map((u,p)=>`<img src="${y(u)}" alt="${y(n.name)} screenshot ${p+1}" loading="eager" decoding="async" class="modal-screenshot" data-idx="${p}">`).join("")}
                </div>
                <div class="modal-dots" aria-hidden="true">
                    ${n.screenshots.map((u,p)=>`<span class="modal-dot${p===0?" active":""}"></span>`).join("")}
                </div>
            </div>`:"",i=n.permissions.length>0?`<div class="modal-permissions">
                <span class="modal-permissions-label">Permissions:</span>
                ${n.permissions.map(u=>`<span class="modal-perm-tag" title="${y(u.usageDescription)}">${w(u.type)}</span>`).join("")}
            </div>`:"",l=n.changelog?`<div class="modal-changelog">
            <strong>What's New</strong>
            <p>${w(n.changelog)}</p>
        </div>`:"",d=(e.developerIndex?.get(n.developer)??[]).filter(u=>u.id!==n.id),h=d.length>0?`<div class="modal-more-section">
                <h4>More by ${w(n.developer)}</h4>
                <div class="modal-more-row">
                    ${d.map(u=>`<button type="button" class="modal-more-item" data-app-id="${y(u.id)}" aria-label="View ${y(u.name)}">
                            <img src="${y(u.icon)}" alt="" width="48" height="48" loading="lazy" decoding="async" class="modal-more-icon">
                            <span class="modal-more-name">${w(u.name)}</span>
                        </button>`).join("")}
                </div>
            </div>`:"";s.innerHTML=`
        <div class="modal-backdrop"></div>
        <div class="modal-content" role="document">
            <div class="modal-drag-handle" aria-hidden="true"></div>
            <button type="button" class="modal-close" aria-label="Close dialog">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M4 4l8 8M12 4l-8 8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
            </button>
            <div class="modal-header">
                <div class="modal-icon-container">
                    <img src="${y(n.icon)}" alt="${y(n.name)} icon"
                         class="modal-icon" width="88" height="88">
                </div>
                <div class="modal-title-block">
                    <h2 class="modal-title">${w(n.name)}</h2>
                    <p class="modal-developer">${w(n.developer)}</p>
                    <div class="modal-meta">
                        <span class="modal-meta-item">v${w(n.version)}</span>
                        <span class="modal-meta-sep" aria-hidden="true">&bull;</span>
                        <span class="modal-meta-item">${w(n.size)}</span>
                        <span class="modal-meta-sep" aria-hidden="true">&bull;</span>
                        <span class="modal-meta-item">iOS ${w(n.minimumOS)}+</span>
                    </div>
                </div>
            </div>
            ${c}
            <div class="modal-body">
                <p class="modal-description">${w(n.description)}</p>
                ${l}
                ${i}
                <p class="modal-date">Updated ${w(n.date)}</p>
            </div>
            ${h}
            <div class="modal-footer">
                <div class="modal-action-row">
                    ${"share"in navigator?`<button type="button" class="modal-action-btn modal-share-btn" aria-label="Share ${y(n.name)}">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M8 2v8M4 6l4-4 4 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M2 10v3a1 1 0 001 1h10a1 1 0 001-1v-3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
                        Share
                    </button>`:""}
                    <button type="button" class="modal-action-btn modal-copy-btn" aria-label="Copy link to ${y(n.name)}">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M6 6H4a2 2 0 00-2 2v4a2 2 0 002 2h4a2 2 0 002-2v-2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><rect x="6" y="2" width="8" height="8" rx="2" stroke="currentColor" stroke-width="1.5"/></svg>
                        Copy Link
                    </button>
                </div>
                <button type="button" class="modal-download-btn" data-id="${y(n.id)}" aria-label="Download ${y(n.name)} IPA">
                    Download IPA
                </button>
            </div>
        </div>
    `,document.body.appendChild(s),D=s;const g=s.querySelector(".modal-content");g&&(g.style.setProperty("--modal-tint",n.tintColor),g.style.setProperty("--modal-tint-glow",I(n.tintColor,.12)));const f=s.querySelector(".modal-icon");f&&f.addEventListener("error",()=>{f.src=m.FALLBACK_ICON},{once:!0}),s.querySelectorAll(".modal-screenshot").forEach(u=>{u.addEventListener("error",()=>{u.style.display="none"},{once:!0})}),document.body.classList.add("modal-open"),document.body.style.top=`-${e.modalScrollY}px`,s.offsetHeight,s.classList.add("active");const v=s.querySelector(".modal-close");v?.focus(),He(s),P?.(),P=Ue(s),s.querySelector(".modal-backdrop")?.addEventListener("click",()=>k(!1,e)),v?.addEventListener("click",()=>k(!1,e)),s.querySelector(".modal-download-btn")?.addEventListener("click",()=>{V(n.id,e.apps,e.isOnline)}),s.querySelector(".modal-share-btn")?.addEventListener("click",async()=>{const u=`${m.BASE_URL}#app-${encodeURIComponent(n.bundleId)}`;try{await navigator.share({title:`${n.name} ‚Äî Mini's Repo`,text:`Get ${n.name} (v${n.version}) from Mini's IPA Repo`,url:u})}catch(p){p.name!=="AbortError"&&b("Share failed","warning")}});const E=s.querySelector(".modal-copy-btn");E?.addEventListener("click",async()=>{const u=`${m.BASE_URL}#app-${encodeURIComponent(n.bundleId)}`;let p=!1;try{await navigator.clipboard.writeText(u),p=!0}catch{p=We(u)}p?(E.classList.add("copied"),E.innerHTML='<svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M3 8l3 3 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg> Copied!',b("Link copied to clipboard","success"),setTimeout(()=>{E.classList.remove("copied"),E.innerHTML='<svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M6 6H4a2 2 0 00-2 2v4a2 2 0 002 2h4a2 2 0 002-2v-2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><rect x="6" y="2" width="8" height="8" rx="2" stroke="currentColor" stroke-width="1.5"/></svg> Copy Link'},2e3)):b("Failed to copy link","warning")}),s.querySelectorAll(".modal-more-item").forEach(u=>{u.addEventListener("click",()=>{const p=u.dataset.appId;p&&(k(!1,e),setTimeout(()=>R(p,e),400))})}),s.addEventListener("keydown",u=>{if(u.key==="Escape"){u.stopPropagation(),k(!1,e);return}u.key==="Tab"&&Fe(u,s)})}function k(t,e){const o=D;if(!o||!e.modalOpen)return;e.modalOpen=!1,P?.(),P=null,o.classList.remove("active");const n=document.getElementById("themeColor");n&&(n.content="#000000"),document.body.classList.remove("modal-open"),document.body.style.top="",window.scrollTo({top:e.modalScrollY,behavior:"instant"}),!t&&e.modalHistoryPushed?(e.modalHistoryPushed=!1,history.back()):(e.modalHistoryPushed=!1,ae(null,!1,e));const r=e.lastOpenedCardId;e.lastOpenedCardId=null,setTimeout(()=>{o.remove(),D=null},350),r&&document.querySelector(`.app-card[data-app-id="${CSS.escape(r)}"]`)?.focus({preventScroll:!0})}function ae(t,e,o){if(t){const n=`#app-${encodeURIComponent(t)}`;e?(history.replaceState({appModal:!0},"",n),o.modalHistoryPushed=!1):(history.pushState({appModal:!0},"",n),o.modalHistoryPushed=!0)}else history.replaceState(null,"",window.location.pathname+window.location.search)}function ce(t){const e=window.location.hash;if(e&&e.startsWith("#app-")){const o=decodeURIComponent(e.substring(5)),n=t.apps.find(r=>r.bundleId===o||r.id===o);n&&setTimeout(()=>R(n.id,t,!0),100)}}function Ne(t){window.addEventListener("popstate",()=>{t.modalOpen&&!window.location.hash?(t.modalHistoryPushed=!1,k(!0,t)):window.location.hash?.startsWith("#app-")&&ce(t)})}function He(t){const e=t.querySelector(".modal-screenshots-track"),o=t.querySelectorAll(".modal-dot");if(!e||o.length===0)return;const n=e.parentElement;if(!n)return;n.setAttribute("tabindex","0"),n.setAttribute("role","listbox"),n.setAttribute("aria-label","Screenshot carousel, use arrow keys to navigate");let r=0;const s=c=>{r=c,o.forEach((i,l)=>{i.classList.toggle("active",l===r)})};n.addEventListener("scroll",()=>{const c=n.scrollLeft,i=e.querySelectorAll(".modal-screenshot");if(i.length===0)return;const l=i[0].offsetWidth+12,d=Math.round(c/l);d!==r&&s(d)},{passive:!0}),n.addEventListener("keydown",c=>{if(c.key!=="ArrowLeft"&&c.key!=="ArrowRight")return;c.preventDefault();const i=e.querySelectorAll(".modal-screenshot");if(i.length===0)return;const l=i[0].offsetWidth+12;c.key==="ArrowRight"?r=Math.min(r+1,i.length-1):r=Math.max(r-1,0),n.scrollTo({left:r*l,behavior:"smooth"}),s(r)})}function Ue(t){const e=t.querySelector(".modal-icon");if(!e)return null;const o=s=>{const c=e.getBoundingClientRect(),i=c.left+c.width/2,l=c.top+c.height/2,d=(s.clientX-i)/(c.width/2),g=(s.clientY-l)/(c.height/2)*-8,f=d*8;e.style.transform=`perspective(200px) rotateX(${g}deg) rotateY(${f}deg)`},n=()=>{e.style.transform=""};t.addEventListener("mousemove",o),t.addEventListener("mouseleave",n);let r=null;return"DeviceOrientationEvent"in window&&(r=s=>{const c=(s.beta??0)/90,i=(s.gamma??0)/90;e.style.transform=`perspective(200px) rotateX(${c*-10}deg) rotateY(${i*10}deg)`},window.addEventListener("deviceorientation",r,{passive:!0})),()=>{t.removeEventListener("mousemove",o),t.removeEventListener("mouseleave",n),r&&(window.removeEventListener("deviceorientation",r),r=null),e.style.transform=""}}function qe(t){const e=[t.icon,...t.screenshots].filter(Boolean),o=new Set;document.querySelectorAll('link[rel="preload"][as="image"]').forEach(n=>{o.add(n.href)});for(const n of e){let r;try{r=new URL(n,window.location.href).href}catch{continue}if(o.has(r))continue;const s=document.createElement("link");s.rel="preload",s.as="image",s.href=n,document.head.appendChild(s),setTimeout(()=>s.remove(),3e4)}}function Fe(t,e){const o=e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(o.length===0)return;const n=o[0],r=o[o.length-1];t.shiftKey&&document.activeElement===n?(t.preventDefault(),r.focus()):!t.shiftKey&&document.activeElement===r&&(t.preventDefault(),n.focus())}function We(t){try{const e=document.createElement("textarea");e.value=t,e.style.cssText="position:fixed;left:-9999px;opacity:0",document.body.appendChild(e),e.select();const o=document.execCommand("copy");return document.body.removeChild(e),o}catch{return!1}}const ze=`
attribute vec2 a_pos;
void main() { gl_Position = vec4(a_pos, 0.0, 1.0); }
`,Ge=`
precision mediump float;
uniform float u_time;
uniform vec2 u_res;

vec3 pal(float t) {
    vec3 a = vec3(0.486, 0.227, 0.918);
    vec3 b = vec3(0.165, 0.118, 0.353);
    vec3 c = vec3(0.659, 0.333, 0.969);
    return a + b * cos(6.283 * (c * t + vec3(0.0, 0.33, 0.67)));
}

float hash(vec2 p) {
    return fract(sin(dot(p, vec2(127.1, 311.7))) * 43758.5453);
}

float noise(vec2 p) {
    vec2 i = floor(p);
    vec2 f = fract(p);
    f = f * f * (3.0 - 2.0 * f);
    return mix(
        mix(hash(i), hash(i + vec2(1.0, 0.0)), f.x),
        mix(hash(i + vec2(0.0, 1.0)), hash(i + vec2(1.0, 1.0)), f.x),
        f.y
    );
}

void main() {
    vec2 uv = gl_FragCoord.xy / u_res;
    float t = u_time * 0.08;
    float n = noise(uv * 3.0 + t);
    vec3 c1 = pal(uv.x * 0.4 + n * 0.3 + t);
    vec3 c2 = pal(length(uv - 0.5) * 0.6 + t * 0.7);
    vec3 col = mix(c1, c2, n * 0.5 + 0.25);
    float fade = smoothstep(1.2, 0.0, length(uv - vec2(0.5, 0.3)) * 1.5);
    gl_FragColor = vec4(col * fade * 0.3, 1.0);
}
`;function je(t){const e=t.getContext("webgl",{alpha:!1,antialias:!1,powerPreference:"low-power"});if(!e)return null;const o=J(e,e.VERTEX_SHADER,ze),n=J(e,e.FRAGMENT_SHADER,Ge);if(!o||!n)return null;const r=e.createProgram();if(e.attachShader(r,o),e.attachShader(r,n),e.linkProgram(r),!e.getProgramParameter(r,e.LINK_STATUS))return console.warn("[HeroGL] Link failed:",e.getProgramInfoLog(r)),null;e.useProgram(r);const s=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,s),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,1]),e.STATIC_DRAW);const c=e.getAttribLocation(r,"a_pos");e.enableVertexAttribArray(c),e.vertexAttribPointer(c,2,e.FLOAT,!1,0,0);const i=e.getUniformLocation(r,"u_time"),l=e.getUniformLocation(r,"u_res");let d=!0,h=0;function g(){const v=Math.min(window.devicePixelRatio,1.5),E=t.clientWidth*v,u=t.clientHeight*v;(t.width!==E||t.height!==u)&&(t.width=E,t.height=u,e.viewport(0,0,E,u))}function f(v){d&&(h++,h%2===0&&(g(),e.uniform1f(i,v*.001),e.uniform2f(l,t.width,t.height),e.drawArrays(e.TRIANGLE_STRIP,0,4)),requestAnimationFrame(f))}return g(),requestAnimationFrame(f),()=>{d=!1,e.deleteProgram(r),e.deleteShader(o),e.deleteShader(n),e.deleteBuffer(s)}}function J(t,e,o){const n=t.createShader(e);return t.shaderSource(n,o),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:(console.warn("[HeroGL] Shader error:",t.getShaderInfoLog(n)),t.deleteShader(n),null)}let $=null,F=null;function Ye(t,e){if(!("serviceWorker"in navigator))return;const o=()=>{navigator.serviceWorker.register("./sw.js").then(r=>{r.addEventListener("updatefound",()=>{$=r.installing,$?.addEventListener("statechange",()=>{$?.state==="installed"&&navigator.serviceWorker.controller&&Ve()})}),F=setInterval(()=>{r.update().catch(()=>{})},m.SW_UPDATE_INTERVAL),"sync"in r&&r.sync.register("sync-data").catch(()=>{})}).catch(r=>console.error("SW registration failed:",r))};document.readyState==="complete"?o():window.addEventListener("load",o,{once:!0});let n=!1;navigator.serviceWorker.addEventListener("controllerchange",()=>{n||(n=!0,window.location.reload())}),navigator.serviceWorker.addEventListener("message",r=>{r.data?.type==="DATA_UPDATED"&&e()})}function Ve(){b("New version available!","info",{text:"REFRESH",callback:()=>{$?.postMessage({action:"skipWaiting"})}})}function Ke(t){window.addEventListener("beforeinstallprompt",n=>{n.preventDefault(),t.deferredInstallPrompt=n,Xe()}),window.addEventListener("appinstalled",()=>{t.deferredInstallPrompt=null,W(),b("App installed successfully!","success");try{const n=parseInt(localStorage.getItem("install_count")??"0",10);localStorage.setItem("install_count",String(n+1)),localStorage.setItem("installed_at",new Date().toISOString())}catch{}}),window.matchMedia("(display-mode: standalone)").matches&&document.body.classList.add("pwa-installed"),document.getElementById("btn-install")?.addEventListener("click",Ze),document.getElementById("btn-install-dismiss")?.addEventListener("click",W)}function Xe(){const t=document.getElementById("installBanner");t&&(t.removeAttribute("hidden"),requestAnimationFrame(()=>requestAnimationFrame(()=>t.classList.add("visible"))))}function W(){const t=document.getElementById("installBanner");t&&(t.classList.remove("visible"),setTimeout(()=>t.setAttribute("hidden",""),400))}async function Ze(){const t=window.__state?.deferredInstallPrompt;t&&(t.prompt(),await t.userChoice,W())}function Je(t){const e=document.getElementById("offlineBar");function o(){t.isOnline=navigator.onLine,e&&(t.isOnline?(e.classList.remove("visible"),setTimeout(()=>e.setAttribute("hidden",""),350)):(e.removeAttribute("hidden"),requestAnimationFrame(()=>requestAnimationFrame(()=>e.classList.add("visible"))))),document.querySelectorAll(".card-get-btn").forEach(n=>{n.classList.toggle("offline-disabled",!t.isOnline)})}window.addEventListener("online",()=>{o(),b("Back online","success")},{passive:!0}),window.addEventListener("offline",()=>{o(),b("You are offline","warning")},{passive:!0}),o()}function Qe(t){if(!("setAppBadge"in navigator))return;const e=Date.now(),o=1440*60*1e3,n=t.filter(r=>{const s=new Date(r.date+"T00:00:00Z").getTime();return e-s<o}).length;n>0?navigator.setAppBadge(n).catch(()=>{}):navigator.clearAppBadge?.().catch(()=>{})}function et(){F&&clearInterval(F)}async function tt(){try{if(localStorage.clear(),"caches"in window){const t=await caches.keys();await Promise.all(t.map(e=>caches.delete(e)))}indexedDB.deleteDatabase("minis-repo")}catch{}window.location.reload()}const a={apps:[],filteredApps:[],searchTerm:"",activeCategory:"all",sortMode:"recent",isLoading:!0,isOnline:navigator.onLine,modalOpen:!1,modalScrollY:0,lastOpenedCardId:null,modalHistoryPushed:!1,deferredInstallPrompt:null,toastTimer:null,renderGeneration:0,recentSearches:[],searchOverlayOpen:!1,developerIndex:new Map};window.__state=a;let K=null,z=null,G=null,B=[],Q="",ee="all",te="recent";document.addEventListener("DOMContentLoaded",async()=>{try{pt(),mt(),Ye(a,ut),Ke(a),Je(a),Ne(a),lt(),(window.requestIdleCallback??(o=>setTimeout(o,0)))(()=>st());const e=await Se("searches","recent");e&&(a.recentSearches=e),a.apps=await le(),a.isLoading=!1,de(),a.apps.length===0?ne("No apps available in this repository"):(he(a.apps.length),rt(),ue(),Pe(a.apps),ot(),L(!0),ce(a),Qe(a.apps),ct())}catch(t){console.error("Initialization error:",t),ne(t.message??"Failed to initialize")}});async function le(){const t=new AbortController,e=setTimeout(()=>t.abort(),m.FETCH_TIMEOUT),o=document.getElementById("appGrid");o&&o.setAttribute("aria-busy","true");try{const n=await fetch(m.API_ENDPOINT,{signal:t.signal,cache:"no-cache"});if(clearTimeout(e),!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);let r;try{r=await n.json()}catch{throw new Error("Data corruption: Unable to parse app manifest.")}if(!r?.apps||!Array.isArray(r.apps))throw new Error("Invalid manifest structure");return r.apps.filter(s=>s.versions?.length>0).map((s,c)=>{const i=s.versions[0],l=Ce(s.bundleIdentifier??"");return{id:Le(s.bundleIdentifier,c),name:s.name??"Unknown App",bundleId:s.bundleIdentifier??"",developer:s.developerName??"Unknown",description:s.localizedDescription??"",icon:s.iconURL??m.FALLBACK_ICON,version:i.version??"Unknown",date:i.date??"",downloadUrl:i.downloadURL??"",category:l,size:be(i.size),sizeBytes:i.size??0,changelog:i.localizedDescription??"",tintColor:we(s.tintColor),subtitle:s.subtitle??"",minimumOS:i.minOSVersion??"15.0",permissions:Te(s.permissions??[]),screenshots:s.screenshotURLs??[],_searchName:(s.name??"").toLowerCase(),_searchDev:(s.developerName??"").toLowerCase(),_searchDesc:(s.localizedDescription??"").toLowerCase(),_wordStartsName:O((s.name??"").toLowerCase()),_wordStartsDev:O((s.developerName??"").toLowerCase()),_wordStartsDesc:O((s.localizedDescription??"").toLowerCase())}})}catch(n){throw n.name==="AbortError"?new Error("Request timeout ‚Äî please check your connection"):n}finally{clearTimeout(e),o&&o.removeAttribute("aria-busy")}}function de(){a.developerIndex=new Map;for(const t of a.apps){const e=a.developerIndex.get(t.developer);e?e.push(t):a.developerIndex.set(t.developer,[t])}}function L(t=!1){!t&&a.searchTerm===Q&&a.activeCategory===ee&&a.sortMode===te||(Q=a.searchTerm,ee=a.activeCategory,te=a.sortMode,a.renderGeneration++,a.searchTerm?(B=Re(a.searchTerm,a.apps).filter(o=>a.activeCategory==="all"||o.app.category===a.activeCategory),a.filteredApps=B.map(o=>o.app)):(B=[],a.filteredApps=a.apps.filter(e=>a.activeCategory==="all"||e.category===a.activeCategory)),a.searchTerm||(a.sortMode==="alpha"?a.filteredApps.sort((e,o)=>e.name.localeCompare(o.name)):a.filteredApps.sort((e,o)=>o.date>e.date?1:o.date<e.date?-1:0)),K?.setItems(a.filteredApps),nt())}function nt(){const t=document.getElementById("searchResultsCount");if(!t)return;const e=a.filteredApps.length,o=a.apps.length;!a.searchTerm&&a.activeCategory==="all"?t.textContent=`${o} apps available, showing all ${e}`:e===0?t.textContent="No apps found":t.textContent=`${o} apps available, filtered to ${e}`}function ot(){const t=document.getElementById("appGrid");t&&(t.innerHTML="",K=new Me(t,{createCardNode:Oe,bindCard:(e,o,n)=>{const r=B.find(s=>s.app.id===o.id);$e(e,o,n,r?.nameMatches)},onCardClick:e=>R(e,a)}),t.addEventListener("click",e=>{const o=e.target.closest(".card-get-btn");if(o){e.stopPropagation();const n=o.dataset.id;n&&V(n,a.apps,a.isOnline)}}))}function rt(){const t=a.apps.find(r=>r.bundleId===m.FEATURED_BUNDLE_ID);if(!t)return;const e=document.getElementById("featuredSection"),o=document.getElementById("featuredCard");if(!e||!o)return;De(t,e,o,r=>R(r,a)),o.querySelector(".featured-get-btn")?.addEventListener("click",r=>{r.stopPropagation(),V(t.id,a.apps,a.isOnline)})}function st(){const t=document.getElementById("heroCanvas");t&&(z=je(t),z&&t.classList.add("active"))}function ue(){const t={all:a.apps.length};for(const e of a.apps)t[e.category]=(t[e.category]||0)+1;document.querySelectorAll(".category-pill").forEach(e=>{const o=e.dataset.category;if(!o)return;const n=t[o];if(n===void 0)return;let r=e.querySelector(".category-count");r||(r=document.createElement("span"),r.className="category-count",r.setAttribute("aria-hidden","true"),e.appendChild(r)),r.textContent=String(n)})}function he(t){const e=document.getElementById("appCountText");e&&(e.textContent=`${t} Apps`)}function U(){a.searchOverlayOpen=!0;const t=document.getElementById("searchOverlay"),e=document.getElementById("searchOverlayInput");!t||!e||(t.classList.add("active"),document.body.classList.add("search-overlay-open"),e.value=a.searchTerm,e.focus(),it(),j())}function T(){a.searchOverlayOpen=!1;const t=document.getElementById("searchOverlay");if(!t)return;document.getElementById("searchOverlayInput")?.blur(),t.classList.remove("active"),document.body.classList.remove("search-overlay-open");const o=document.getElementById("searchOverlayResults");o&&(o.innerHTML=""),document.getElementById("recentSearches")?.classList.remove("hidden");const n=document.getElementById("searchBox");n&&(n.value=a.searchTerm,n.placeholder=a.searchTerm?"":"Search apps..."),pe()}function it(){const t=document.getElementById("recentSearches");if(t){if(a.recentSearches.length===0){t.innerHTML="";return}t.innerHTML=a.recentSearches.map(e=>`<button type="button" class="recent-search-pill" data-term="${e.replace(/"/g,"&quot;")}">${e.replace(/</g,"&lt;")}</button>`).join("")}}function pe(){const t=document.getElementById("searchClearBtn"),e=document.querySelector(".search-shortcut");t&&t.classList.toggle("visible",a.searchTerm.length>0),e&&(e.style.display=a.searchTerm.length>0?"none":"")}function at(){a.searchTerm="";const t=document.getElementById("searchBox");t&&(t.value="",t.placeholder="Search apps..."),L(),pe()}function x(t){!t||t.length<2||(a.recentSearches=[t,...a.recentSearches.filter(e=>e!==t)].slice(0,m.MAX_RECENT_SEARCHES),ke("searches","recent",a.recentSearches).catch(()=>{}))}function j(){const t=document.getElementById("searchOverlayResults"),e=document.getElementById("recentSearches");if(!t)return;const o=a.searchTerm;if(!o){t.innerHTML="",e?.classList.remove("hidden");return}e?.classList.add("hidden");const n=B;if(n.length===0){t.innerHTML=`
            <div class="search-overlay-no-results">
                <div class="search-overlay-no-results-icon" aria-hidden="true">üîç</div>
                <p>No apps found for "<strong>${w(o)}</strong>"</p>
            </div>`;return}const r=20,s=n.slice(0,r);t.innerHTML=s.map(c=>{const i=re(c.app.name,c.nameMatches),l=w(c.app.developer);return`<button type="button" class="search-result-item" data-app-id="${y(c.app.id)}" role="option">
            <img class="search-result-icon" src="${y(c.app.icon)}" alt="" width="44" height="44" loading="lazy" />
            <div class="search-result-info">
                <div class="search-result-name">${i}</div>
                <div class="search-result-dev">${l}</div>
            </div>
            <span class="search-result-get" aria-hidden="true">GET</span>
        </button>`}).join(""),n.length>r&&t.insertAdjacentHTML("beforeend",`<div class="search-overlay-no-results" style="padding:var(--s3) var(--s4);font-size:0.8em;">
                and ${n.length-r} more‚Ä¶
            </div>`)}function ct(){const t=document.getElementById("scrollTopBtn"),e=document.querySelector(".hero");!t||!e||(G=new IntersectionObserver(o=>{const n=o[0].isIntersecting;t.classList.toggle("visible",!n),t.setAttribute("aria-hidden",String(n))},{threshold:0}),G.observe(e),t.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})}))}function lt(){const t=document.getElementById("appGrid");t&&(t.setAttribute("aria-busy","true"),t.innerHTML=Array(6).fill(0).map((e,o)=>`
        <div class="skeleton-card stagger-${o%3+1}" aria-hidden="true">
            <div class="skeleton skeleton-icon"></div>
            <div class="skeleton-lines">
                <div class="skeleton skeleton-text short"></div>
                <div class="skeleton skeleton-text medium"></div>
            </div>
            <div class="skeleton skeleton-button"></div>
        </div>`).join(""))}function ne(t){const e=document.getElementById("appGrid");if(!e)return;e.removeAttribute("aria-busy"),e.innerHTML=`
        <div class="error-state">
            <div class="error-icon" aria-hidden="true">
                <svg width="48" height="48" viewBox="0 0 48 48" fill="none"><circle cx="24" cy="24" r="22" stroke="currentColor" stroke-width="2"/><path d="M24 14v12M24 32v2" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/></svg>
            </div>
            <h3>Something went wrong</h3>
            <p></p>
            <button type="button" class="retry-btn" onclick="location.reload()">Try Again</button>
        </div>
    `;const o=e.querySelector(".error-state p");o&&(o.textContent=String(t))}let oe=0;const dt=1e4;async function ut(){const t=Date.now();if(!(t-oe<dt)){oe=t;try{const e=await le();a.apps=e,de(),he(e.length),ue(),L(!0),b("App list updated","info")}catch{}}}async function ht(){const t=document.getElementById("btn-copy-url"),e=document.getElementById("copyUrlLabel");try{await navigator.clipboard.writeText(m.MANIFEST_URL)}catch{const o=document.createElement("textarea");o.value=m.MANIFEST_URL,o.style.cssText="position:fixed;left:-9999px;opacity:0",document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o)}b("Manifest URL copied","success"),t&&e&&(e.textContent="Copied!",t.classList.add("copied"),setTimeout(()=>{e.textContent="Copy URL",t.classList.remove("copied")},2e3))}function pt(){const t=document.getElementById("searchBox");t?.addEventListener("focus",()=>{a.searchOverlayOpen||U(),t.blur()}),document.getElementById("searchClearBtn")?.addEventListener("click",i=>{i.stopPropagation(),at()});const e=document.getElementById("searchOverlayInput"),o=Ae(i=>{a.searchTerm=i.toLowerCase().trim(),L(),j()},m.SEARCH_DEBOUNCE);e&&(e.addEventListener("input",i=>{o(i.target.value)}),e.addEventListener("keydown",i=>{i.key==="Escape"&&(o.cancel(),x(a.searchTerm),T()),i.key==="Enter"&&(i.preventDefault(),o.cancel(),a.searchTerm=e.value.toLowerCase().trim(),L(),x(a.searchTerm),T())})),document.getElementById("searchOverlayClose")?.addEventListener("click",()=>{o.cancel(),x(a.searchTerm),T()}),document.getElementById("searchOverlay")?.addEventListener("click",i=>{i.target===i.currentTarget&&(o.cancel(),x(a.searchTerm),T())}),document.getElementById("recentSearches")?.addEventListener("click",i=>{const l=i.target.closest(".recent-search-pill");if(!l)return;const d=l.dataset.term??"",h=document.getElementById("searchOverlayInput");h&&(h.value=d),a.searchTerm=d.toLowerCase(),L(),j()}),document.getElementById("searchOverlayResults")?.addEventListener("click",i=>{const l=i.target.closest(".search-result-item");if(!l)return;const d=l.dataset.appId;d&&(x(a.searchTerm),T(),R(d,a))}),document.addEventListener("keydown",i=>{if((i.metaKey||i.ctrlKey)&&i.key==="k"){i.preventDefault(),U();return}if(i.key==="/"&&!a.modalOpen&&!a.searchOverlayOpen){const l=document.activeElement;l instanceof HTMLInputElement||l instanceof HTMLTextAreaElement||l?.isContentEditable||(i.preventDefault(),U())}i.key==="Escape"&&a.modalOpen&&k(!1,a)});const n=document.getElementById("categoryFilters");n&&(n.addEventListener("click",i=>{const l=i.target.closest(".category-pill");if(!l)return;const d=l.getBoundingClientRect(),h=document.createElement("span");h.className="pill-ripple",h.style.left=`${i.clientX-d.left}px`,h.style.top=`${i.clientY-d.top}px`,l.appendChild(h),h.addEventListener("animationend",()=>h.remove());const g=l.dataset.category;a.activeCategory=g===a.activeCategory&&g!=="all"?"all":g,n.querySelectorAll(".category-pill").forEach(f=>{const v=f.dataset.category===a.activeCategory;f.classList.toggle("active",v),f.setAttribute("aria-selected",String(v)),f.setAttribute("tabindex",v?"0":"-1")}),L()}),n.addEventListener("keydown",i=>{if(i.key==="ArrowRight"||i.key==="ArrowLeft"){i.preventDefault();const l=Array.from(n.querySelectorAll(".category-pill")),d=l.indexOf(document.activeElement);if(d===-1)return;const h=i.key==="ArrowRight"?Math.min(d+1,l.length-1):Math.max(d-1,0);l[h].focus()}}));const r=document.getElementById("sortRecent"),s=document.getElementById("sortAlpha");function c(i){a.sortMode=i,r?.classList.toggle("active",i==="recent"),r?.setAttribute("aria-pressed",String(i==="recent")),s?.classList.toggle("active",i==="alpha"),s?.setAttribute("aria-pressed",String(i==="alpha")),L()}r?.addEventListener("click",()=>c("recent")),s?.addEventListener("click",()=>c("alpha")),document.getElementById("btn-trollapps")?.addEventListener("click",()=>{window.location.href=`trollapps://add?url=${encodeURIComponent(m.API_ENDPOINT)}`}),document.getElementById("btn-sidestore")?.addEventListener("click",()=>{window.location.href=`sidestore://source?url=${encodeURIComponent(m.API_ENDPOINT)}`}),document.getElementById("btn-copy-url")?.addEventListener("click",ht),document.getElementById("btn-reset")?.addEventListener("click",async()=>{confirm("Reset all local data and cache?")&&await tt()})}function mt(){window.addEventListener("unhandledrejection",t=>console.warn("Unhandled rejection:",t.reason)),window.addEventListener("error",t=>console.error("Global error:",t.error))}window.addEventListener("beforeunload",()=>{z?.(),K?.destroy(),G?.disconnect(),et()});
