(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function o(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=o(r);fetch(r.href,i)}})();const K=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||window.location.hostname==="0.0.0.0"||window.location.hostname==="[::1]"),p={API_ENDPOINT:K?"./mini.json":"https://OofMini.github.io/Minis-Repo/mini.json",FALLBACK_ICON:"./apps/repo-icon.png",FEATURED_BUNDLE_ID:"com.spotify.client",SEARCH_DEBOUNCE:150,TOAST_DURATION:4e3,FETCH_TIMEOUT:1e4,CARD_POOL_SIZE:24,OVERSCAN_ROWS:3,CARD_ROW_HEIGHT:88,CARD_GAP:12,SW_UPDATE_INTERVAL:1800*1e3,MAX_RECENT_SEARCHES:5,IDB_NAME:"minis-repo",IDB_VERSION:1,SPRING_BOUNCY:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",SPRING_SMOOTH:"cubic-bezier(0.4, 0, 0.2, 1)",MANIFEST_URL:"https://OofMini.github.io/Minis-Repo/mini.json",BASE_URL:K?window.location.origin+window.location.pathname:"https://OofMini.github.io/Minis-Repo/"},X=document.createElement("div");function E(t){return t?(X.textContent=t,X.innerHTML):""}function w(t){return t?String(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}const ue="#a78bfa";function he(t){return t&&/^#[0-9A-Fa-f]{6}$/.test(t)?t:ue}function A(t,e){if(!t||t.length<7)return`rgba(167, 139, 250, ${e})`;const o=parseInt(t.slice(1,3),16),n=parseInt(t.slice(3,5),16),r=parseInt(t.slice(5,7),16);return isNaN(o)||isNaN(n)||isNaN(r)?`rgba(167, 139, 250, ${e})`:`rgba(${o}, ${n}, ${r}, ${e})`}function pe(t){return!t||typeof t!="number"?"Unknown":t>=1073741824?`${(t/1073741824).toFixed(1)} GB`:`${(t/1048576).toFixed(0)} MB`}function me(t){if(!t)return"";const e=new Date(t+"T00:00:00Z"),n=Date.now()-e.getTime(),r=Math.floor(n/864e5);return r<0?"Just now":r===0?"Today":r===1?"Yesterday":r<7?`${r}d ago`:r<30?`${Math.floor(r/7)}w ago`:r<365?`${Math.floor(r/30)}mo ago`:`${Math.floor(r/365)}y ago`}function fe(t){const e=t.toLowerCase();return e.includes("youtubemusic")||e.includes("spotify")||e.includes("music")?"Music":e.includes("youtube")||e.includes("video")?"Video":e.includes("social")||e.includes("tweet")||e.includes("twitter")?"Social":e.includes("editor")||e.includes("inshot")||e.includes("photo")||e.includes("reface")||e.includes("doublicatapp")?"Creative":"Utilities"}function ge(t,e){return t?t.toLowerCase():`unknown-${e}`}function ve(t){if(!t||typeof t!="string")return!1;try{const e=new URL(t);return e.protocol==="https:"&&e.hostname.length>0}catch{return!1}}function ye(t,e){let o;return(...n)=>{clearTimeout(o),o=setTimeout(()=>t(...n),e)}}function we(t,e){return new Promise(o=>{try{const n=indexedDB.open("minis-repo",1);n.onupgradeneeded=()=>{const r=n.result;r.objectStoreNames.contains("searches")||r.createObjectStore("searches",{keyPath:"key"}),r.objectStoreNames.contains("data")||r.createObjectStore("data",{keyPath:"key"})},n.onsuccess=()=>{try{const s=n.result.transaction(t,"readonly").objectStore(t).get(e);s.onsuccess=()=>o(s.result?.value),s.onerror=()=>o(void 0)}catch{o(void 0)}},n.onerror=()=>o(void 0)}catch{o(void 0)}})}function be(t,e,o){return new Promise(n=>{try{const r=indexedDB.open("minis-repo",1);r.onupgradeneeded=()=>{const i=r.result;i.objectStoreNames.contains("searches")||i.createObjectStore("searches",{keyPath:"key"}),i.objectStoreNames.contains("data")||i.createObjectStore("data",{keyPath:"key"})},r.onsuccess=()=>{try{const i=r.result.transaction(t,"readwrite");i.objectStore(t).put({key:e,value:o}),i.oncomplete=()=>n(),i.onerror=()=>n()}catch{n()}},r.onerror=()=>n()}catch{n()}})}function Ee(t){return Array.isArray(t)?t.map(e=>typeof e=="string"?{type:e,usageDescription:""}:typeof e=="object"&&e!==null&&"type"in e?{type:e.type,usageDescription:e.usageDescription??""}:null).filter(e=>e!==null):[]}function P(t,e,o){if(!e)return{score:0,ranges:[]};if(e===t)return{score:1*o,ranges:[[0,e.length]]};if(e.startsWith(t))return{score:.95*o,ranges:[[0,t.length]]};const n=e.indexOf(t);if(n>=0)return{score:(.8+(n===0||/\W/.test(e[n-1])?.05:0))*o,ranges:[[n,n+t.length]]};const r=Ce(e),i=Le(t,e,r);if(i)return{score:.65*o,ranges:i};const s=Ae(t,e);if(s){const c=s[s.length-1][1]-s[0][0],l=t.length/Math.max(c,1);return{score:Math.min(.5,.3+l*.2)*o,ranges:s}}return{score:0,ranges:[]}}function Ce(t){const e=[0];for(let o=1;o<t.length;o++)/\W/.test(t[o-1])&&/\w/.test(t[o])&&e.push(o);return e}function Le(t,e,o){if(o.length<t.length)return null;const n=[];let r=0;for(let i=0;i<t.length;i++){let s=!1;for(;r<o.length;){if(e[o[r]]===t[i]){n.push([o[r],o[r]+1]),r++,s=!0;break}r++}if(!s)return null}return n}function Ae(t,e){const o=[];let n=0;for(let r=0;r<t.length;r++){let i=!1;for(;n<e.length;){if(e[n]===t[r]){o.length>0&&o[o.length-1][1]===n?o[o.length-1][1]=n+1:o.push([n,n+1]),n++,i=!0;break}n++}if(!i)return null}return o}function Se(t,e){const o=t.toLowerCase().trim();if(!o)return e.map(r=>({app:r,score:1,nameMatches:[]}));const n=[];for(const r of e){const i=P(o,r._searchName,1),s=P(o,r._searchDev,.7),c=P(o,r._searchDesc,.4);let l=0,u=[];i.score>=s.score&&i.score>=c.score?(l=i.score,u=i.ranges):s.score>=c.score?(l=s.score,u=[]):(l=c.score,u=[]),l>0&&n.push({app:r,score:l,nameMatches:i.score>0?i.ranges:u})}return n.sort((r,i)=>i.score!==r.score?i.score-r.score:r.app.name.localeCompare(i.app.name)),n}function Ie(t,e){if(!e.length)return x(t);let o="",n=0;const r=[...e].sort((s,c)=>s[0]-c[0]),i=[];for(const s of r)i.length>0&&s[0]<=i[i.length-1][1]?i[i.length-1][1]=Math.max(i[i.length-1][1],s[1]):i.push([...s]);for(const[s,c]of i)n<s&&(o+=x(t.slice(n,s))),o+=`<mark>${x(t.slice(s,c))}</mark>`,n=c;return n<t.length&&(o+=x(t.slice(n))),o}function x(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}class ke{constructor(e,o){this.items=[],this.pool=[],this.activeNodes=new Map,this.columns=1,this.rowHeight=p.CARD_ROW_HEIGHT,this.gap=p.CARD_GAP,this.containerTop=0,this.rafId=0,this.resizeObserver=null,this.container=e,this.callbacks=o,this.innerContainer=document.createElement("div"),this.innerContainer.className="vs-inner",this.innerContainer.setAttribute("role","list"),this.innerContainer.setAttribute("aria-label","App list"),this.container.appendChild(this.innerContainer);for(let n=0;n<p.CARD_POOL_SIZE;n++){const r=o.createCardNode();r.style.position="absolute",r.style.left="0",r.style.top="0",r.style.display="none",r.setAttribute("role","listitem"),this.innerContainer.appendChild(r),this.pool.push({el:r,appId:null})}this.setupListeners(),this.computeLayout()}setupListeners(){const e=()=>{this.rafId||(this.rafId=requestAnimationFrame(()=>{this.rafId=0,this.render()}))};window.addEventListener("scroll",e,{passive:!0}),this.resizeObserver=new ResizeObserver(()=>{this.computeLayout(),this.render()}),this.resizeObserver.observe(this.container),this.innerContainer.addEventListener("click",o=>{const n=o.target.closest("[data-app-id]");if(!n||o.target.closest("button"))return;const i=n.dataset.appId;i&&this.callbacks.onCardClick(i)}),this.innerContainer.addEventListener("keydown",o=>{const n=o.target.closest("[data-app-id]");if(n){if(o.key==="Enter"||o.key===" "){o.preventDefault();const r=n.dataset.appId;r&&this.callbacks.onCardClick(r);return}["ArrowRight","ArrowLeft","ArrowDown","ArrowUp"].includes(o.key)&&(o.preventDefault(),this.navigateGrid(n,o.key))}})}navigateGrid(e,o){const n=e.dataset.appId;if(!n)return;const r=this.items.findIndex(s=>s.id===n);if(r===-1)return;let i=r;switch(o){case"ArrowRight":i=Math.min(r+1,this.items.length-1);break;case"ArrowLeft":i=Math.max(r-1,0);break;case"ArrowDown":i=Math.min(r+this.columns,this.items.length-1);break;case"ArrowUp":i=Math.max(r-this.columns,0);break}if(i!==r){const s=this.items[i];this.scrollToIndex(i),requestAnimationFrame(()=>{const c=this.activeNodes.get(s.id);c&&c.el.focus({preventScroll:!1})})}}computeLayout(){const e=getComputedStyle(this.container),o=this.container.clientWidth,n=parseFloat(e.paddingLeft)||0,r=parseFloat(e.paddingRight)||0,i=o-n-r;i>=900?this.columns=3:i>=540?this.columns=2:this.columns=1;const s=e.getPropertyValue("--vs-gap")?.trim();s&&(this.gap=parseInt(s,10)||p.CARD_GAP),this.containerTop=this.container.getBoundingClientRect().top+window.scrollY}setItems(e){this.items=e;const n=Math.ceil(e.length/this.columns)*(this.rowHeight+this.gap)-this.gap;this.innerContainer.style.height=`${Math.max(n,0)}px`;for(const[r,i]of this.activeNodes)i.el.style.display="none",i.appId=null,this.pool.push(i),this.activeNodes.delete(r);this.render()}acquireNode(){if(this.pool.length>0)return this.pool.pop()}releaseNode(e){e.appId&&this.activeNodes.delete(e.appId),e.el.style.display="none",e.appId=null,this.pool.push(e)}render(){if(this.items.length===0){for(const[,g]of this.activeNodes)this.releaseNode(g);return}const e=window.scrollY,o=window.innerHeight,n=o*2,r=this.containerTop,i=this.rowHeight+this.gap,s=Math.ceil(this.items.length/this.columns),c=e-r-n,l=e+o-r+n,u=Math.max(0,Math.floor(c/i)),h=Math.min(s-1,Math.ceil(l/i)),m=u*this.columns,f=Math.min((h+1)*this.columns,this.items.length),v=new Set;for(let g=m;g<f;g++)v.add(this.items[g].id);for(const[g,I]of this.activeNodes)v.has(g)||this.releaseNode(I);const b=this.container.clientWidth,d=getComputedStyle(this.container),y=parseFloat(d.paddingLeft)||0,se=parseFloat(d.paddingRight)||0,V=(b-y-se-(this.columns-1)*this.gap)/this.columns;for(let g=m;g<f;g++){const I=this.items[g];let L=this.activeNodes.get(I.id);if(!L){if(L=this.acquireNode(),!L)continue;L.appId=I.id,this.activeNodes.set(I.id,L),this.callbacks.bindCard(L.el,I,g)}const ae=Math.floor(g/this.columns),ce=g%this.columns,le=y+ce*(V+this.gap),de=ae*i;L.el.style.transform=`translate3d(${le}px, ${de}px, 0)`,L.el.style.width=`${V}px`,L.el.style.height=`${this.rowHeight}px`,L.el.style.display=""}}scrollToIndex(e){const o=Math.floor(e/this.columns),n=this.rowHeight+this.gap,r=this.containerTop+o*n,i=window.innerHeight;(r<window.scrollY||r+this.rowHeight>window.scrollY+i)&&window.scrollTo({top:r-i/3,behavior:"smooth"}),requestAnimationFrame(()=>this.render())}setRowHeight(e){if(e>0&&e!==this.rowHeight){this.rowHeight=e;const n=Math.ceil(this.items.length/this.columns)*(this.rowHeight+this.gap)-this.gap;this.innerContainer.style.height=`${Math.max(n,0)}px`,this.render()}}getActiveNodeCount(){return this.activeNodes.size}destroy(){this.rafId&&cancelAnimationFrame(this.rafId),this.resizeObserver?.disconnect(),this.innerContainer.remove()}}let D=null,S=null,O=[],G=!1;function Q(){return D||(D=document.getElementById("toast")),D}function C(t,e="info",o){const n=Q();if(n){if(G){O.push({msg:t,type:e,action:o}),O.length>2&&U();return}ee(n,t,e,o)}}function ee(t,e,o,n){G=!0,S&&(clearTimeout(S),S=null),t.innerHTML="";const r=document.createElement("span");if(r.textContent=e,t.appendChild(r),n){const i=document.createElement("button");i.type="button",i.textContent=n.text,i.addEventListener("click",()=>{n.callback(),U()}),t.appendChild(i)}t.setAttribute("aria-live",o==="error"||o==="warning"?"assertive":"polite"),t.className=`toast ${o} show`,S=setTimeout(()=>{U()},p.TOAST_DURATION)}function U(){const t=Q();if(t&&(t.classList.remove("show"),G=!1,S&&(clearTimeout(S),S=null),O.length>0)){const e=O.shift();setTimeout(()=>{ee(t,e.msg,e.type,e.action)},300)}}function Te(){const t=document.createElement("article");return t.className="app-card",t.tabIndex=0,t.innerHTML=`
        <div class="card-accent" aria-hidden="true"></div>
        <div class="card-body">
            <div class="card-icon-wrap">
                <img class="card-icon" width="64" height="64" loading="lazy" decoding="async" alt="">
                <span class="card-version-badge" aria-hidden="true"></span>
            </div>
            <div class="card-info">
                <h3 class="card-name"></h3>
                <p class="card-developer"></p>
                <p class="card-meta"></p>
            </div>
            <button type="button" class="card-get-btn" aria-label="">
                <span class="card-get-text">GET</span>
                <span class="card-get-spinner" aria-hidden="true"></span>
                <span class="card-get-check" aria-hidden="true"></span>
            </button>
        </div>
        <div class="card-separator" aria-hidden="true"></div>
    `,t}function xe(t,e,o,n){t.dataset.appId=e.id,t.setAttribute("aria-label",`${e.name} by ${e.developer} — tap to view details`),t.style.setProperty("--tint",e.tintColor),t.style.setProperty("--tint-10",A(e.tintColor,.1)),t.style.setProperty("--tint-20",A(e.tintColor,.2)),t.style.setProperty("--tint-40",A(e.tintColor,.4));const r=t.querySelector(".card-accent");r&&(r.style.backgroundColor=e.tintColor);const i=t.querySelector(".card-icon");i&&i.src!==e.icon&&!i.src.endsWith(e.icon)&&(i.src=e.icon,i.alt=`${e.name} icon`,i.onerror=()=>{i.src=p.FALLBACK_ICON});const s=t.querySelector(".card-version-badge");s&&(s.textContent=`v${e.version}`);const c=t.querySelector(".card-name");c&&(n&&n.length>0?c.innerHTML=Ie(e.name,n):c.textContent=e.name);const l=t.querySelector(".card-developer");l&&(l.textContent=e.developer);const u=t.querySelector(".card-meta");u&&(u.textContent=`${e.size} · ${me(e.date)}`);const h=t.querySelector(".card-get-btn");if(h){h.dataset.id=e.id,h.setAttribute("aria-label",`Download ${e.name}`),h.className="card-get-btn",h.style.setProperty("--btn-tint",e.tintColor),h.style.setProperty("--btn-tint-bg",A(e.tintColor,.12));const m=h.querySelector(".card-get-text");m&&(m.style.display="");const f=h.querySelector(".card-get-spinner");f&&(f.style.display="none");const v=h.querySelector(".card-get-check");v&&(v.style.display="none")}}function j(t,e,o){const n=e.find(s=>s.id===t);if(!n)return;if(!o){C("You are offline. Downloads require a connection.","warning");return}if(!ve(n.downloadUrl)){C("Security Block: URL must be HTTPS","error");return}const r=document.querySelector(`.card-get-btn[data-id="${CSS.escape(t)}"]`);r&&Be(r);const i=document.createElement("a");i.href=n.downloadUrl,i.target="_blank",i.rel="noopener noreferrer",i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i),C(`Downloading ${n.name}`,"success")}function Be(t){const e=t.querySelector(".card-get-text"),o=t.querySelector(".card-get-spinner"),n=t.querySelector(".card-get-check");!e||!o||!n||(t.classList.add("downloading"),e.style.display="none",o.style.display="",setTimeout(()=>{o.style.display="none",n.style.display="",t.classList.remove("downloading"),t.classList.add("downloaded"),setTimeout(()=>{t.classList.remove("downloaded"),e.style.display="",n.style.display="none"},2e3)},800))}function Me(t,e,o,n){const r=o.querySelector(".featured-icon"),i=o.querySelector(".featured-name"),s=o.querySelector(".featured-dev"),c=o.querySelector(".featured-desc"),l=o.querySelector(".featured-get-btn");r&&(r.src=t.icon,r.alt=`${t.name} icon`,r.onerror=()=>{r.src=p.FALLBACK_ICON}),i&&(i.textContent=t.name),s&&(s.textContent=t.developer),c&&(c.textContent=t.description),l&&(l.dataset.id=t.id,l.setAttribute("aria-label",`Download ${t.name}`),l.style.setProperty("--btn-tint",t.tintColor)),o.style.setProperty("--tint",t.tintColor),o.style.setProperty("--tint-10",A(t.tintColor,.1)),o.style.setProperty("--tint-20",A(t.tintColor,.2)),o.setAttribute("data-app-id",t.id),o.setAttribute("aria-label",`${t.name} — featured app, tap to view details`),e.removeAttribute("hidden"),e.classList.add("visible"),o.addEventListener("click",u=>{u.target.closest("button")||n(t.id)}),o.addEventListener("keydown",u=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),n(t.id))})}function Re(t){const e=document.createElement("link");e.rel="preconnect",e.href="https://objects.githubusercontent.com",e.crossOrigin="anonymous",document.head.appendChild(e);const o=Math.min(6,t.length);for(let n=0;n<o;n++){const r=document.createElement("link");r.rel="preload",r.as="image",r.href=t[n].icon,n<3&&r.setAttribute("fetchpriority","high"),document.head.appendChild(r)}}let $=null,q=null;function _(t,e,o=!1){const n=e.apps.find(d=>d.id===t);if(!n||e.modalOpen)return;e.modalOpen=!0,e.modalScrollY=window.scrollY,e.lastOpenedCardId=t,Pe(n),$?.remove(),te(n.bundleId,o,e);const r=document.getElementById("themeColor");r&&(r.content="#0a0a0f");const i=document.createElement("div");i.id="appModal",i.className="modal-overlay",i.setAttribute("role","dialog"),i.setAttribute("aria-modal","true"),i.setAttribute("aria-label",`${n.name} details`);const s=n.screenshots.length>0?`<div class="modal-screenshots" role="region" aria-label="Screenshots">
                <div class="modal-screenshots-track">
                    ${n.screenshots.map((d,y)=>`<img src="${w(d)}" alt="${w(n.name)} screenshot ${y+1}" loading="eager" decoding="async" class="modal-screenshot" data-idx="${y}">`).join("")}
                </div>
                <div class="modal-dots" aria-hidden="true">
                    ${n.screenshots.map((d,y)=>`<span class="modal-dot${y===0?" active":""}"></span>`).join("")}
                </div>
            </div>`:"",c=n.permissions.length>0?`<div class="modal-permissions">
                <span class="modal-permissions-label">Permissions:</span>
                ${n.permissions.map(d=>`<span class="modal-perm-tag" title="${w(d.usageDescription)}">${E(d.type)}</span>`).join("")}
            </div>`:"",l=n.changelog?`<div class="modal-changelog">
            <strong>What's New</strong>
            <p>${E(n.changelog)}</p>
        </div>`:"",u=e.apps.filter(d=>d.developer===n.developer&&d.id!==n.id),h=u.length>0?`<div class="modal-more-section">
                <h4>More by ${E(n.developer)}</h4>
                <div class="modal-more-row">
                    ${u.map(d=>`<button type="button" class="modal-more-item" data-app-id="${w(d.id)}" aria-label="View ${w(d.name)}">
                            <img src="${w(d.icon)}" alt="" width="48" height="48" loading="lazy" decoding="async" class="modal-more-icon">
                            <span class="modal-more-name">${E(d.name)}</span>
                        </button>`).join("")}
                </div>
            </div>`:"";i.innerHTML=`
        <div class="modal-backdrop"></div>
        <div class="modal-content" role="document">
            <div class="modal-drag-handle" aria-hidden="true"></div>
            <button type="button" class="modal-close" aria-label="Close dialog">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M4 4l8 8M12 4l-8 8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
            </button>
            <div class="modal-header">
                <div class="modal-icon-container">
                    <img src="${w(n.icon)}" alt="${w(n.name)} icon"
                         class="modal-icon" width="88" height="88">
                </div>
                <div class="modal-title-block">
                    <h2 class="modal-title">${E(n.name)}</h2>
                    <p class="modal-developer">${E(n.developer)}</p>
                    <div class="modal-meta">
                        <span class="modal-meta-item">v${E(n.version)}</span>
                        <span class="modal-meta-sep" aria-hidden="true">&bull;</span>
                        <span class="modal-meta-item">${E(n.size)}</span>
                        <span class="modal-meta-sep" aria-hidden="true">&bull;</span>
                        <span class="modal-meta-item">iOS ${E(n.minimumOS)}+</span>
                    </div>
                </div>
            </div>
            ${s}
            <div class="modal-body">
                <p class="modal-description">${E(n.description)}</p>
                ${l}
                ${c}
                <p class="modal-date">Updated ${E(n.date)}</p>
            </div>
            ${h}
            <div class="modal-footer">
                <div class="modal-action-row">
                    ${"share"in navigator?`<button type="button" class="modal-action-btn modal-share-btn" aria-label="Share ${w(n.name)}">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M8 2v8M4 6l4-4 4 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M2 10v3a1 1 0 001 1h10a1 1 0 001-1v-3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
                        Share
                    </button>`:""}
                    <button type="button" class="modal-action-btn modal-copy-btn" aria-label="Copy link to ${w(n.name)}">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M6 6H4a2 2 0 00-2 2v4a2 2 0 002 2h4a2 2 0 002-2v-2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><rect x="6" y="2" width="8" height="8" rx="2" stroke="currentColor" stroke-width="1.5"/></svg>
                        Copy Link
                    </button>
                </div>
                <button type="button" class="modal-download-btn" data-id="${w(n.id)}" aria-label="Download ${w(n.name)} IPA">
                    Download IPA
                </button>
            </div>
        </div>
    `,document.body.appendChild(i),$=i;const m=i.querySelector(".modal-content");m&&(m.style.setProperty("--modal-tint",n.tintColor),m.style.setProperty("--modal-tint-glow",A(n.tintColor,.12)));const f=i.querySelector(".modal-icon");f&&f.addEventListener("error",()=>{f.src=p.FALLBACK_ICON},{once:!0}),i.querySelectorAll(".modal-screenshot").forEach(d=>{d.addEventListener("error",()=>{d.style.display="none"},{once:!0})}),document.body.classList.add("modal-open"),document.body.style.top=`-${e.modalScrollY}px`,i.offsetHeight,i.classList.add("active");const v=i.querySelector(".modal-close");v?.focus(),$e(i),q=_e(i),i.querySelector(".modal-backdrop")?.addEventListener("click",()=>k(!1,e)),v?.addEventListener("click",()=>k(!1,e)),i.querySelector(".modal-download-btn")?.addEventListener("click",()=>{j(n.id,e.apps,e.isOnline)}),i.querySelector(".modal-share-btn")?.addEventListener("click",async()=>{const d=`${p.BASE_URL}#app-${encodeURIComponent(n.bundleId)}`;try{await navigator.share({title:`${n.name} — Mini's Repo`,text:`Get ${n.name} (v${n.version}) from Mini's IPA Repo`,url:d})}catch(y){y.name!=="AbortError"&&C("Share failed","warning")}});const b=i.querySelector(".modal-copy-btn");b?.addEventListener("click",async()=>{const d=`${p.BASE_URL}#app-${encodeURIComponent(n.bundleId)}`;try{await navigator.clipboard.writeText(d)}catch{Ne(d)}b.classList.add("copied"),b.innerHTML='<svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M3 8l3 3 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg> Copied!',C("Link copied to clipboard","success"),setTimeout(()=>{b.classList.remove("copied"),b.innerHTML='<svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M6 6H4a2 2 0 00-2 2v4a2 2 0 002 2h4a2 2 0 002-2v-2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><rect x="6" y="2" width="8" height="8" rx="2" stroke="currentColor" stroke-width="1.5"/></svg> Copy Link'},2e3)}),i.querySelectorAll(".modal-more-item").forEach(d=>{d.addEventListener("click",()=>{const y=d.dataset.appId;y&&(k(!1,e),setTimeout(()=>_(y,e),400))})}),i.addEventListener("keydown",d=>{if(d.key==="Escape"){d.stopPropagation(),k(!1,e);return}d.key==="Tab"&&De(d,i)})}function k(t,e){const o=$;if(!o||!e.modalOpen)return;e.modalOpen=!1,q?.(),q=null,o.classList.remove("active");const n=document.getElementById("themeColor");n&&(n.content="#000000"),document.body.classList.remove("modal-open"),document.body.style.top="",window.scrollTo({top:e.modalScrollY,behavior:"instant"}),!t&&e.modalHistoryPushed?(e.modalHistoryPushed=!1,history.back()):(e.modalHistoryPushed=!1,te(null,!1,e));const r=e.lastOpenedCardId;e.lastOpenedCardId=null,setTimeout(()=>{o.remove(),$=null},350),r&&document.querySelector(`.app-card[data-app-id="${CSS.escape(r)}"]`)?.focus({preventScroll:!0})}function te(t,e,o){if(t){const n=`#app-${encodeURIComponent(t)}`;e?(history.replaceState({appModal:!0},"",n),o.modalHistoryPushed=!1):(history.pushState({appModal:!0},"",n),o.modalHistoryPushed=!0)}else history.replaceState(null,"",window.location.pathname+window.location.search)}function ne(t){const e=window.location.hash;if(e&&e.startsWith("#app-")){const o=decodeURIComponent(e.substring(5)),n=t.apps.find(r=>r.bundleId===o||r.id===o);n&&setTimeout(()=>_(n.id,t,!0),100)}}function Oe(t){window.addEventListener("popstate",()=>{t.modalOpen&&!window.location.hash?(t.modalHistoryPushed=!1,k(!0,t)):window.location.hash?.startsWith("#app-")&&ne(t)})}function $e(t){const e=t.querySelector(".modal-screenshots-track"),o=t.querySelectorAll(".modal-dot");if(!e||o.length===0)return;const n=e.parentElement;if(!n)return;let r=0;n.addEventListener("scroll",()=>{const i=n.scrollLeft,s=e.querySelectorAll(".modal-screenshot");if(s.length===0)return;const c=s[0].offsetWidth+12,l=Math.round(i/c);l!==r&&(r=l,o.forEach((u,h)=>{u.classList.toggle("active",h===r)}))},{passive:!0})}function _e(t){const e=t.querySelector(".modal-icon");if(!e)return null;const o=i=>{const s=e.getBoundingClientRect(),c=s.left+s.width/2,l=s.top+s.height/2,u=(i.clientX-c)/(s.width/2),m=(i.clientY-l)/(s.height/2)*-8,f=u*8;e.style.transform=`perspective(200px) rotateX(${m}deg) rotateY(${f}deg)`},n=()=>{e.style.transform=""};t.addEventListener("mousemove",o),t.addEventListener("mouseleave",n);let r=null;return"DeviceOrientationEvent"in window&&(r=i=>{const s=(i.beta??0)/90,c=(i.gamma??0)/90;e.style.transform=`perspective(200px) rotateX(${s*-10}deg) rotateY(${c*10}deg)`},window.addEventListener("deviceorientation",r,{passive:!0})),()=>{t.removeEventListener("mousemove",o),t.removeEventListener("mouseleave",n),r&&window.removeEventListener("deviceorientation",r),e.style.transform=""}}function Pe(t){const e=[t.icon,...t.screenshots].filter(Boolean),o=new Set;document.querySelectorAll('link[rel="preload"][as="image"]').forEach(n=>{o.add(n.href)});for(const n of e){let r;try{r=new URL(n,window.location.href).href}catch{continue}if(o.has(r))continue;const i=document.createElement("link");i.rel="preload",i.as="image",i.href=n,document.head.appendChild(i),setTimeout(()=>i.remove(),3e4)}}function De(t,e){const o=e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(o.length===0)return;const n=o[0],r=o[o.length-1];t.shiftKey&&document.activeElement===n?(t.preventDefault(),r.focus()):!t.shiftKey&&document.activeElement===r&&(t.preventDefault(),n.focus())}function Ne(t){const e=document.createElement("textarea");e.value=t,e.style.cssText="position:fixed;left:-9999px;opacity:0",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}const He=`
attribute vec2 a_pos;
void main() { gl_Position = vec4(a_pos, 0.0, 1.0); }
`,Ue=`
precision mediump float;
uniform float u_time;
uniform vec2 u_res;

vec3 pal(float t) {
    vec3 a = vec3(0.486, 0.227, 0.918);
    vec3 b = vec3(0.165, 0.118, 0.353);
    vec3 c = vec3(0.659, 0.333, 0.969);
    return a + b * cos(6.283 * (c * t + vec3(0.0, 0.33, 0.67)));
}

float hash(vec2 p) {
    return fract(sin(dot(p, vec2(127.1, 311.7))) * 43758.5453);
}

float noise(vec2 p) {
    vec2 i = floor(p);
    vec2 f = fract(p);
    f = f * f * (3.0 - 2.0 * f);
    return mix(
        mix(hash(i), hash(i + vec2(1.0, 0.0)), f.x),
        mix(hash(i + vec2(0.0, 1.0)), hash(i + vec2(1.0, 1.0)), f.x),
        f.y
    );
}

void main() {
    vec2 uv = gl_FragCoord.xy / u_res;
    float t = u_time * 0.08;
    float n = noise(uv * 3.0 + t);
    vec3 c1 = pal(uv.x * 0.4 + n * 0.3 + t);
    vec3 c2 = pal(length(uv - 0.5) * 0.6 + t * 0.7);
    vec3 col = mix(c1, c2, n * 0.5 + 0.25);
    float fade = smoothstep(1.2, 0.0, length(uv - vec2(0.5, 0.3)) * 1.5);
    gl_FragColor = vec4(col * fade * 0.3, 1.0);
}
`;function qe(t){const e=t.getContext("webgl",{alpha:!1,antialias:!1,powerPreference:"low-power"});if(!e)return null;const o=Z(e,e.VERTEX_SHADER,He),n=Z(e,e.FRAGMENT_SHADER,Ue);if(!o||!n)return null;const r=e.createProgram();if(e.attachShader(r,o),e.attachShader(r,n),e.linkProgram(r),!e.getProgramParameter(r,e.LINK_STATUS))return console.warn("[HeroGL] Link failed:",e.getProgramInfoLog(r)),null;e.useProgram(r);const i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,1]),e.STATIC_DRAW);const s=e.getAttribLocation(r,"a_pos");e.enableVertexAttribArray(s),e.vertexAttribPointer(s,2,e.FLOAT,!1,0,0);const c=e.getUniformLocation(r,"u_time"),l=e.getUniformLocation(r,"u_res");let u=!0,h=0;function m(){const v=Math.min(window.devicePixelRatio,1.5),b=t.clientWidth*v,d=t.clientHeight*v;(t.width!==b||t.height!==d)&&(t.width=b,t.height=d,e.viewport(0,0,b,d))}function f(v){u&&(h++,h%2===0&&(m(),e.uniform1f(c,v*.001),e.uniform2f(l,t.width,t.height),e.drawArrays(e.TRIANGLE_STRIP,0,4)),requestAnimationFrame(f))}return m(),requestAnimationFrame(f),()=>{u=!1,e.deleteProgram(r),e.deleteShader(o),e.deleteShader(n),e.deleteBuffer(i)}}function Z(t,e,o){const n=t.createShader(e);return t.shaderSource(n,o),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:(console.warn("[HeroGL] Shader error:",t.getShaderInfoLog(n)),t.deleteShader(n),null)}let M=null,F=null;function Fe(t,e){if(!("serviceWorker"in navigator))return;navigator.serviceWorker.register("./sw.js").then(n=>{n.addEventListener("updatefound",()=>{M=n.installing,M?.addEventListener("statechange",()=>{M?.state==="installed"&&navigator.serviceWorker.controller&&We()})}),F=setInterval(()=>{n.update().catch(()=>{})},p.SW_UPDATE_INTERVAL),"sync"in n&&n.sync.register("sync-data").catch(()=>{})}).catch(n=>console.error("SW registration failed:",n));let o=!1;navigator.serviceWorker.addEventListener("controllerchange",()=>{o||(o=!0,window.location.reload())}),navigator.serviceWorker.addEventListener("message",n=>{n.data?.type==="DATA_UPDATED"&&e()})}function We(){C("New version available!","info",{text:"REFRESH",callback:()=>{M?.postMessage({action:"skipWaiting"})}})}function ze(t){window.addEventListener("beforeinstallprompt",n=>{n.preventDefault(),t.deferredInstallPrompt=n,Ge()}),window.addEventListener("appinstalled",()=>{t.deferredInstallPrompt=null,W(),C("App installed successfully!","success");try{const n=parseInt(localStorage.getItem("install_count")??"0",10);localStorage.setItem("install_count",String(n+1)),localStorage.setItem("installed_at",new Date().toISOString())}catch{}}),window.matchMedia("(display-mode: standalone)").matches&&document.body.classList.add("pwa-installed"),document.getElementById("btn-install")?.addEventListener("click",je),document.getElementById("btn-install-dismiss")?.addEventListener("click",W)}function Ge(){const t=document.getElementById("installBanner");t&&(t.removeAttribute("hidden"),requestAnimationFrame(()=>requestAnimationFrame(()=>t.classList.add("visible"))))}function W(){const t=document.getElementById("installBanner");t&&(t.classList.remove("visible"),setTimeout(()=>t.setAttribute("hidden",""),400))}async function je(){const t=window.__state?.deferredInstallPrompt;t&&(t.prompt(),await t.userChoice,W())}function Ye(t){const e=document.getElementById("offlineBar");function o(){t.isOnline=navigator.onLine,e&&(t.isOnline?(e.classList.remove("visible"),setTimeout(()=>e.setAttribute("hidden",""),350)):(e.removeAttribute("hidden"),requestAnimationFrame(()=>requestAnimationFrame(()=>e.classList.add("visible"))))),document.querySelectorAll(".card-get-btn").forEach(n=>{n.classList.toggle("offline-disabled",!t.isOnline)})}window.addEventListener("online",()=>{o(),C("Back online","success")},{passive:!0}),window.addEventListener("offline",()=>{o(),C("You are offline","warning")},{passive:!0}),o()}function Ve(t){if(!("setAppBadge"in navigator))return;const e=Date.now(),o=1440*60*1e3,n=t.filter(r=>{const i=new Date(r.date+"T00:00:00Z").getTime();return e-i<o}).length;n>0?navigator.setAppBadge(n).catch(()=>{}):navigator.clearAppBadge?.().catch(()=>{})}function Ke(){F&&clearInterval(F)}async function Xe(){try{if(localStorage.clear(),"caches"in window){const t=await caches.keys();await Promise.all(t.map(e=>caches.delete(e)))}indexedDB.deleteDatabase("minis-repo")}catch{}window.location.reload()}const a={apps:[],filteredApps:[],searchTerm:"",activeCategory:"all",sortMode:"recent",isLoading:!0,isOnline:navigator.onLine,modalOpen:!1,modalScrollY:0,lastOpenedCardId:null,modalHistoryPushed:!1,deferredInstallPrompt:null,toastTimer:null,renderGeneration:0,recentSearches:[],searchOverlayOpen:!1};window.__state=a;let Y=null,z=null,R=[];document.addEventListener("DOMContentLoaded",async()=>{try{st(),at(),Fe(a,rt),ze(a),Ye(a),Oe(a),et(),ot();const t=await we("searches","recent");t&&(a.recentSearches=t),a.apps=await oe(),a.isLoading=!1,a.apps.length===0?J("No apps available in this repository"):(ie(a.apps.length),Qe(),re(),Re(a.apps),Je(),T(),ne(a),Ve(a.apps),nt())}catch(t){console.error("Initialization error:",t),J(t.message??"Failed to initialize")}});async function oe(){const t=new AbortController,e=setTimeout(()=>t.abort(),p.FETCH_TIMEOUT),o=document.getElementById("appGrid");o&&o.setAttribute("aria-busy","true");try{const n=await fetch(p.API_ENDPOINT,{signal:t.signal,cache:"no-cache"});if(clearTimeout(e),!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);let r;try{r=await n.json()}catch{throw new Error("Data corruption: Unable to parse app manifest.")}if(!r?.apps||!Array.isArray(r.apps))throw new Error("Invalid manifest structure");return r.apps.filter(i=>i.versions?.length>0).map((i,s)=>{const c=i.versions[0],l=fe(i.bundleIdentifier??"");return{id:ge(i.bundleIdentifier,s),name:i.name??"Unknown App",bundleId:i.bundleIdentifier??"",developer:i.developerName??"Unknown",description:i.localizedDescription??"",icon:i.iconURL??p.FALLBACK_ICON,version:c.version??"Unknown",date:c.date??"",downloadUrl:c.downloadURL??"",category:l,size:pe(c.size),sizeBytes:c.size??0,changelog:c.localizedDescription??"",tintColor:he(i.tintColor),subtitle:i.subtitle??"",minimumOS:c.minOSVersion??"15.0",permissions:Ee(i.permissions??[]),screenshots:i.screenshotURLs??[],_searchName:(i.name??"").toLowerCase(),_searchDev:(i.developerName??"").toLowerCase(),_searchDesc:(i.localizedDescription??"").toLowerCase()}})}catch(n){throw n.name==="AbortError"?new Error("Request timeout — please check your connection"):n}finally{clearTimeout(e),o&&o.removeAttribute("aria-busy")}}function T(){a.renderGeneration++,a.searchTerm?(R=Se(a.searchTerm,a.apps).filter(e=>a.activeCategory==="all"||e.app.category===a.activeCategory),a.filteredApps=R.map(e=>e.app)):(R=[],a.filteredApps=a.apps.filter(t=>a.activeCategory==="all"||t.category===a.activeCategory)),a.searchTerm||(a.sortMode==="alpha"?a.filteredApps.sort((t,e)=>t.name.localeCompare(e.name)):a.filteredApps.sort((t,e)=>e.date>t.date?1:e.date<t.date?-1:0)),Y?.setItems(a.filteredApps),Ze()}function Ze(){const t=document.getElementById("searchResultsCount");if(!t)return;const e=a.filteredApps.length,o=a.apps.length;!a.searchTerm&&a.activeCategory==="all"?t.textContent=`${o} apps available, showing all ${e}`:e===0?t.textContent="No apps found":t.textContent=`${o} apps available, filtered to ${e}`}function Je(){const t=document.getElementById("appGrid");t&&(t.innerHTML="",Y=new ke(t,{createCardNode:Te,bindCard:(e,o,n)=>{const r=R.find(i=>i.app.id===o.id);xe(e,o,n,r?.nameMatches)},onCardClick:e=>_(e,a)}),t.addEventListener("click",e=>{const o=e.target.closest(".card-get-btn");if(o){e.stopPropagation();const n=o.dataset.id;n&&j(n,a.apps,a.isOnline)}}))}function Qe(){const t=a.apps.find(r=>r.bundleId===p.FEATURED_BUNDLE_ID);if(!t)return;const e=document.getElementById("featuredSection"),o=document.getElementById("featuredCard");if(!e||!o)return;Me(t,e,o,r=>_(r,a)),o.querySelector(".featured-get-btn")?.addEventListener("click",r=>{r.stopPropagation(),j(t.id,a.apps,a.isOnline)})}function et(){const t=document.getElementById("heroCanvas");t&&(z=qe(t),z&&t.classList.add("active"))}function re(){const t={all:a.apps.length};for(const e of a.apps)t[e.category]=(t[e.category]||0)+1;document.querySelectorAll(".category-pill").forEach(e=>{const o=e.dataset.category;if(!o)return;const n=t[o];if(n===void 0)return;let r=e.querySelector(".category-count");r||(r=document.createElement("span"),r.className="category-count",r.setAttribute("aria-hidden","true"),e.appendChild(r)),r.textContent=String(n)})}function ie(t){const e=document.getElementById("appCountText");e&&(e.textContent=`${t} Apps`)}function N(){a.searchOverlayOpen=!0;const t=document.getElementById("searchOverlay"),e=document.getElementById("searchOverlayInput");!t||!e||(t.classList.add("active"),document.body.classList.add("search-overlay-open"),e.value=a.searchTerm,e.focus(),tt())}function H(){a.searchOverlayOpen=!1;const t=document.getElementById("searchOverlay");t&&(t.classList.remove("active"),document.body.classList.remove("search-overlay-open"))}function tt(){const t=document.getElementById("recentSearches");if(t){if(a.recentSearches.length===0){t.innerHTML="";return}t.innerHTML=a.recentSearches.map(e=>`<button type="button" class="recent-search-pill" data-term="${e.replace(/"/g,"&quot;")}">${e.replace(/</g,"&lt;")}</button>`).join("")}}function B(t){!t||t.length<2||(a.recentSearches=[t,...a.recentSearches.filter(e=>e!==t)].slice(0,p.MAX_RECENT_SEARCHES),be("searches","recent",a.recentSearches).catch(()=>{}))}function nt(){const t=document.getElementById("scrollTopBtn"),e=document.querySelector(".hero");if(!t||!e)return;new IntersectionObserver(n=>{const r=n[0].isIntersecting;t.classList.toggle("visible",!r),t.setAttribute("aria-hidden",String(r))},{threshold:0}).observe(e),t.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})})}function ot(){const t=document.getElementById("appGrid");t&&(t.setAttribute("aria-busy","true"),t.innerHTML=Array(6).fill(0).map((e,o)=>`
        <div class="skeleton-card stagger-${o%3+1}" aria-hidden="true">
            <div class="skeleton skeleton-icon"></div>
            <div class="skeleton-lines">
                <div class="skeleton skeleton-text short"></div>
                <div class="skeleton skeleton-text medium"></div>
            </div>
            <div class="skeleton skeleton-button"></div>
        </div>`).join(""))}function J(t){const e=document.getElementById("appGrid");if(!e)return;e.removeAttribute("aria-busy"),e.innerHTML=`
        <div class="error-state">
            <div class="error-icon" aria-hidden="true">
                <svg width="48" height="48" viewBox="0 0 48 48" fill="none"><circle cx="24" cy="24" r="22" stroke="currentColor" stroke-width="2"/><path d="M24 14v12M24 32v2" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/></svg>
            </div>
            <h3>Something went wrong</h3>
            <p></p>
            <button type="button" class="retry-btn" onclick="location.reload()">Try Again</button>
        </div>
    `;const o=e.querySelector(".error-state p");o&&(o.textContent=String(t))}async function rt(){try{const t=await oe();a.apps=t,ie(t.length),re(),T(),C("App list updated","info")}catch{}}async function it(){const t=document.getElementById("btn-copy-url"),e=document.getElementById("copyUrlLabel");try{await navigator.clipboard.writeText(p.MANIFEST_URL)}catch{const o=document.createElement("textarea");o.value=p.MANIFEST_URL,o.style.cssText="position:fixed;left:-9999px;opacity:0",document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o)}C("Manifest URL copied","success"),t&&e&&(e.textContent="Copied!",t.classList.add("copied"),setTimeout(()=>{e.textContent="Copy URL",t.classList.remove("copied")},2e3))}function st(){document.getElementById("searchBox")?.addEventListener("focus",()=>N());const e=document.getElementById("searchOverlayInput");if(e){const s=ye(c=>{a.searchTerm=c.toLowerCase().trim(),T()},p.SEARCH_DEBOUNCE);e.addEventListener("input",c=>{s(c.target.value)}),e.addEventListener("keydown",c=>{c.key==="Escape"&&(B(a.searchTerm),H()),c.key==="Enter"&&B(a.searchTerm)})}document.getElementById("searchOverlayClose")?.addEventListener("click",()=>{B(a.searchTerm),H()}),document.getElementById("searchOverlay")?.addEventListener("click",s=>{s.target===s.currentTarget&&(B(a.searchTerm),H())}),document.getElementById("recentSearches")?.addEventListener("click",s=>{const c=s.target.closest(".recent-search-pill");if(!c)return;const l=c.dataset.term??"",u=document.getElementById("searchOverlayInput");u&&(u.value=l),a.searchTerm=l.toLowerCase(),T()}),document.addEventListener("keydown",s=>{if((s.metaKey||s.ctrlKey)&&s.key==="k"){s.preventDefault(),N();return}if(s.key==="/"&&!a.modalOpen&&!a.searchOverlayOpen){const c=document.activeElement;c instanceof HTMLInputElement||c instanceof HTMLTextAreaElement||c?.isContentEditable||(s.preventDefault(),N())}s.key==="Escape"&&a.modalOpen&&k(!1,a)});const o=document.getElementById("categoryFilters");o&&(o.addEventListener("click",s=>{const c=s.target.closest(".category-pill");if(!c)return;const l=c.getBoundingClientRect(),u=document.createElement("span");u.className="pill-ripple",u.style.left=`${s.clientX-l.left}px`,u.style.top=`${s.clientY-l.top}px`,c.appendChild(u),u.addEventListener("animationend",()=>u.remove());const h=c.dataset.category;a.activeCategory=h===a.activeCategory&&h!=="all"?"all":h,o.querySelectorAll(".category-pill").forEach(m=>{const f=m.dataset.category===a.activeCategory;m.classList.toggle("active",f),m.setAttribute("aria-selected",String(f)),m.setAttribute("tabindex",f?"0":"-1")}),T()}),o.addEventListener("keydown",s=>{if(s.key==="ArrowRight"||s.key==="ArrowLeft"){s.preventDefault();const c=Array.from(o.querySelectorAll(".category-pill")),l=c.indexOf(document.activeElement);if(l===-1)return;const u=s.key==="ArrowRight"?Math.min(l+1,c.length-1):Math.max(l-1,0);c[u].focus()}}));const n=document.getElementById("sortRecent"),r=document.getElementById("sortAlpha");function i(s){a.sortMode=s,n?.classList.toggle("active",s==="recent"),n?.setAttribute("aria-pressed",String(s==="recent")),r?.classList.toggle("active",s==="alpha"),r?.setAttribute("aria-pressed",String(s==="alpha")),T()}n?.addEventListener("click",()=>i("recent")),r?.addEventListener("click",()=>i("alpha")),document.getElementById("btn-trollapps")?.addEventListener("click",()=>{window.location.href=`trollapps://add?url=${encodeURIComponent(p.API_ENDPOINT)}`}),document.getElementById("btn-sidestore")?.addEventListener("click",()=>{window.location.href=`sidestore://source?url=${encodeURIComponent(p.API_ENDPOINT)}`}),document.getElementById("btn-copy-url")?.addEventListener("click",it),document.getElementById("btn-reset")?.addEventListener("click",async()=>{confirm("Reset all local data and cache?")&&await Xe()})}function at(){window.addEventListener("unhandledrejection",t=>console.warn("Unhandled rejection:",t.reason)),window.addEventListener("error",t=>console.error("Global error:",t.error))}window.addEventListener("beforeunload",()=>{z?.(),Y?.destroy(),Ke()});
